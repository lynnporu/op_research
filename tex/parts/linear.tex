\makeatletter
\def\input@path{{../}}
\makeatother

\providecommand{\main}{..}
\documentclass[\main/book.tex]{subfiles}

\begin{document}

\chapter{Лінійне програмуванння}

Одночасно простим для розуміння та корисним на практиці є математичний апарат розв'язку задач лінійного програмування (ЛП), з яким читач познайомиться у цьому розділі.

\begin{itemize}
 \item У параграфі \sectionref{section:linear:typical} читач дізнається про деякі типові проблеми ЛП та отримає інтуїтивне розуміння того, як варто формулювати ОДР і цінову функцію.
 \item У параграфі \sectionref{section:linear:geometrical} описано графічний метод розв'язку проблем ЛП для $\mathbf{X} \in \mathbb{R}^2$.
 \item Параграф \sectionref{section:linear:simplex} описує симплекс-метод розв'язування ЛП для $n$-вимірних проблем ($\mathbf{X} \in \mathbb{R}^{\geq 2}$).
 \item У параграфі \sectionref{section:linear:integer} читач дізнається про принцип границь та галужень для розв'язування цілочисельної задачі ЛП.
 \item У параграфі \sectionref{section:linear:x_in_0-1} описано постановку та розв'язування ЛП задачі при $\mathbf{X} \in \{0,1\}^n$.
\end{itemize}

Задачу можна назвати лінійною тоді, коли цінова функція є функцією першого степеня~(\ref{eq:p2:linear-phi}), а область допустимих значень може бути описана лінійними рівностями або нерівностями~(\ref{eq:p2:linear-g-set}).

\begin{equation}
\begin{split}
 \varphi(\mathbf{X}) =
 \sum_{j=1}^n c_j x_j =
 \mathbf{c} \mathbf{X}^\top,\;
 \mathbf{c} = \langle c_1, \ldots, c_n \rangle
\end{split}
\label{eq:p2:linear-phi}
\end{equation}

\begin{equation}
 G = \left\{
  \langle x_1, \ldots, x_n \rangle:
  \sum_{j=1}^n a_{ij} x_j\,
   \boxed{\leq, \geq \text{або} =}\,
  b_i
  \,\forall i = \overline{1, m}
 \right\}
 \label{eq:p2:linear-g-set}
\end{equation}

\section{Типові проблеми}
\label{section:linear:typical}

Приведені далі постановки задач є типовими. Вони отримали свою назву від проблеми, у вирішенні якої найкраще використовувати такі означення. Якщо їх проаналізувати, то можна отримати відпрацьований математичний апарат для розв'язання більш специфічних задач.

\subsection{Максимізація прибутку}
\label{section:linear:phi_to_max}

\textit{Фабрика виробляє продукцію $n$ видів. Для неї потрібна певна кількість сировини $m$ видів, при чому її є в обмеженій кількості. Відомо можливий прибуток від реалізації кожного з видів продукції. Якщо існує якийсь оптимальний розподіл всієї сировини на виробництво певних видів продукції так, щоби отримати якнайбільший прибуток, то яким буде такий розподіл?}

Якщо між двома некерованими змінними існує відношення, то доцільно описати його у вигляді матриці. Тому нехай в $\mathbf{A}$ міститимуться елементи $a_{ij}$, кожен з яких означатиме витрату сировини $i$-ого виду на виготовлення продукції $j$-ого виду. Ще одна некерована змінна $\mathbf{b} = \langle b_1, \ldots, b_m \rangle^\top$ позначатиме кількість відповідної сировини кожного виду, доступної на фабриці. Прибуток від реалізації можна визначити вектором $\mathbf{c} = \langle c_1, \ldots, c_n \rangle^\top$.

Керованою змінною є вектор $\mathbf{X} = \langle x_1, \ldots, x_n \rangle^\top$, кожен елемент якого позначає кількість продукції, яку має виготовити фабрика -- ці дані варто змінювати для досягнення оптимальності.

Тоді умовою допустимості розв'язку буде перш за все виконання обмежень на доступну кількість сировини, та деякі очевидні твердження -- наприклад, те, що ця кількість має бути невід'ємною (\ref{eq:p2:problem:phi_to_max:g_set}).

\begin{equation}
 \mathbf{X} \in G \Leftarrow
 \left\{
  \begin{array}{l}
   \displaystyle \sum_{j=1}^n a_{ij} x_j \leq b_i\;
   \forall i = \overline{1, m} \\
   x_j \geq 0 \; \forall j = \overline{1, n}
  \end{array}
 \right\}
 \label{eq:p2:problem:phi_to_max:g_set}
\end{equation}

\begin{problem}{problem:linear:integer_lp}
Чи можна поставити умову так, щоби знайдені $x_i$ обов'язково повинні були би бути цілими числами?
\end{problem}

В означенні (\ref{eq:p2:problem:phi_to_max:g_set}) фор\-му\-лю\-ва\-ння ${\sum_{j=1}^n a_{ij} x_j}$ позначає суму використаної сировини певного типу на виготовлення ресурсів всіх можливих видів. Відповідно \flqq{}$\leq b_i$\frqq{} позначає, що цією сировини можна використати не більше певної кількості. Умова $\forall i$ означає, що така нерівність повинна виконуватись для всіх видів сировини.

Цінову функцію потрібно вводити так, щоби вона визначала прибутковість прийнятого рішення. Тоді оптимальним розв'язком буде такий, що гарантує досягнення її максимуму (\ref{eq:p2:problem:phi_to_max:price}).

\begin{equation}
 \varphi(\mathbf{X}) =
 \sum_{j=1}^n c_j x_j \rightarrow
 \max_{\mathbf{X} \in G}
 \label{eq:p2:problem:phi_to_max:price}
\end{equation}

\begin{problem}{problem:linear:many_price_fn}
 Якщо існує така задача, для якої потрібно вводити кілька цінових функцій, і оптимізовувати їх одночасно, то якою буде умова такої задачі? Чи існує якийсь універсальний спосіб поєднання кількох оцінок оптимальності в одну?
\end{problem}

\subsection{Мінімізація витрат}

Розглянемо задачу, подібну тій, що поставлена у розділі~\ref{section:linear:phi_to_max}. \textit{Фабрика отримує сировину $n$ видів, з якої виготовляє товар за $m$ різними тех\-но\-ло\-гі\-я\-ми. Кожна з технологій потребує певну комбінацію сировини у різних кількостях. Разом з тим, кожна з технологій спричиняє в атмосферу викид певної кількості кілограм вуглецю. Для кожного виду сировини визначена доступна кількість, яку можна використати для виробництва. Потрібно оптимізувати виробництво так, щоби отримати якомога більше готової продукції, але водночас зменшити кількість шкідливих викидів.}

Що в цій задачі уже відомого? Найперше -- відношення технології та сировини, яку вона потребує. Запишемо це в матрицю $\mathbf{A}$, в якій кожен елемент $a_{ij}$ позначатиме витрату сировини $i$-ого типу за $j$-ою технологією. Викиди, спричинені різними технологіями можна зберігати у векторі $\mathbf{c} = \langle c_1, \ldots, c_m \rangle^\top$, а кількість доступної сировини кожного виду -- як $\mathbf{b} = \langle b_1, \ldots, b_n \rangle^\top$.

Що потрібно знайти? Потрібно знайти кількість товару, яка буде виготовлена за кожною з технологій. Тому позначимо її через вектор $\mathbf{X} = \langle x_1, \ldots, x_m \rangle^\top$. При пошуку значення різних $x_j$ доведеться вирішити дилему: користуватись технологіями, які потребують меншу кількість сировини, але спричиняють більше викидів, чи навпаки?

Будь-який розв'язок $\mathbf{X}$ буде допустимим, якщо задовольнятиме дві умови: використано ресурсів не більше, ніж доступно взагалі, і жоден з $x_j$ не є від'ємним. Тому ознака допустимості розв'язку є такою самою, як і (\ref{eq:p2:problem:phi_to_max:g_set}) -- ми використовуємо ті самі назви змінних, тому формула не втрачає свого змісту. Тепер формулювання ${\sum_{j=1}^n a_{ij} x_j}$ позначатиме кількість сировини певного виду, використаної загалом, за якими технологіями б не відбувалось виробництво.

Допоки розв'язок допустимий, він використовуватиме лише дос\-туп\-ну кількість сировини. Однак різні розв'язки все ще спричиняють різний викид вуглецю, тому оптимальтність кожного з них визначатимемо саме за цим параметром. Цінова функція знову така сама, як і в (\ref{eq:p2:problem:phi_to_max:price}), проте цього разу її доцільно мінімізувати.

\begin{equation}
 \varphi(\mathbf{X}) =
 \mathbf{c} \mathbf{X}^\top
 \rightarrow \min_{\mathbf{X} \in G}
\end{equation}

\begin{note}
Тепер, після ознайомленнями з двома задачами, важливо розуміти, що не існує жодних правил, як варто складати формулювання ОДР чи цінової функції, так само як і неможливо передбачити всі можливі \flqq{}типові задачі\frqq{}. Формулювання будь-якої математичної моделі залежить винятково від області дослідження та винахідливості дослідника.
\end{note}

\subsection{План перевезень}
\label{subsection:linear:transportation_problem}

Досі ми розглядали задачі, де невідомою керованою змінною був вектор -- тобто, кількість чогось різних видів, або оптимальна конфігурація різних характеристик. Чи можливо тепер за допомогою лінійного програмування розв'язати якусь проблему, що встановлюватиме конфігурацію відношення? Тобто, цього разу невідоме $\mathbf{X}$ буде двовимірним -- матрицею.

\textit{Компанія має у своєму розпорядженні $n$ зерносховищ та $m$ постачальників зерна. Кожне зерносховище може зберігати певну кількість тон зерна, купленого у різних постачальників. З ними укладено контракт, за яким компанія зобов'язується викупити щонайменш певну кількість тон за раз. Відомі затрати на перевезення зерна від кожного постачальника до кожного сховища -- скажімо, час, відстань, пальне тощо. Потрібно визначити, скільки зерна між різними постачальниками та відповідними сховищами доцільно перевезти, щоби отримати якомога менші витрати, та перевезти якомога більше вантажу.}

\illustration
 {../imgs/linear/transport-graph.pdf}
 {Кожен з постачальників пропонує $\mathbf{a} = {\langle a_1, \ldots, a_m \rangle}^\top$ тон, а кожне зі сховищ може зберігати до $\mathbf{b} = {\langle b_1, \ldots, b_n \rangle}^\top$. Затрати на перевезення між ними задаються матрицею $\mathbf{C} \in \mathbb{R}^{m \times n}$.}
 {pic:linear:transport_problem}

Отже, умову проблеми можна зобразити у вигляді графа, що на Рис.~\ref{pic:linear:transport_problem}. Зрозуміло, що некерованими змінними є $\mathbf{a}$, $\mathbf{b}$ та $\mathbf{C}$. Тоді розв'язком буде матриця $\mathbf{X}$, кожен елемент $x_{ij}$ якої задаватиме \flqq{}оптимальну\frqq{} кількість тон, яку варто перевезти між $i$-им постачальником та $j$-им сховищем. Саме така конфігурація, що буде задана цією матрицею і гарантуватиме найменші витрати та якнайбільше заповнення сховищ.

\begin{note}
 Ця проблема є класичним випадком транспортної задачі, і для її розв'язку існують інші методи, про які можна дізнатись у наступних розділах. Попри це, розв'язок саме лінійним програмуванням є досить цікавим.
\end{note}

Тепер ОДР повинно мати такі обмеження:

\begin{itemize}
 \item потрібно вивезти весь товар, що надають постачальники;
 \item до кожного зі сховищ не можна привезти більше, ніж воно може вмістити.
\end{itemize}

Тоді умову допустимості розв'язку можна записати як~\ref{eq:linear:problem:matrix_to_matrix:g_set}.

\begin{equation}
 \mathbf{X} \in G \Leftarrow \left\{
 \begin{array}{l}
  \displaystyle
  \sum_{i=1}^m x_{ij} = a_i\; \forall j = \overline{1, n} \\
  \displaystyle
  \sum_{j=1}^n x_{ij} \leq b_j\; \forall i = \overline{1, m}
 \end{array}
 \right\}
 \label{eq:linear:problem:matrix_to_matrix:g_set}
\end{equation}

Щоби порахувати затрати при поточному плані перевезення, достатньо перемножити значення $c_{ij}$ з матриці затрат на значення $x_{ij}$. Оптимальним буде той розв'язок, у якому це значення найменше, тому вводимо цінову функцію (\ref{eq:linear:problem:matrix_to_matrix:price}), і вимагаємо її мінімізації.

\begin{equation}
 \varphi(\mathbf{X}) =
 \sum_{i=1}^m \sum_{j=1}^n
 c_{ij} x_{ij}
 \rightarrow \min_{\mathbf{X} \in G}
 \label{eq:linear:problem:matrix_to_matrix:price}
\end{equation}

\begin{problem}{problem:linear:transportation_problem}
 Нехай матриця $\mathbf{C}$ відображає не затрати на перевезення, а максимальну пропускну здатність маршруту. Скажімо, в день по дорозі між $i$-им постачальником та $j$-им сховищем можна перевезти не більше, ніж $c_{ij}$ тон вантажу. Потрібно знайти таке завантаження $\mathbf{X}$ різних доріг, щоби перевезти якомога більше вантажу. Допускається ситуація, коли не весь вантаж буде вивезено від постачальників. Як сформулювати ОДР та цінову функцію?
\end{problem}

\section{Геометричний сенс}
\label{section:linear:geometrical}

Двовимірні та (іноді) тривимірні випадки лінійного програмування можна розв'язувати графічно. Розуміння геометричних процесів, які відбуваються при відшукуванні розв'язку допоможуть при розв'язуванні багатовимірних задач.

\subsection{Двовимірний випадок}

Розгляньмо випадок, коли вектор $\mathbf{X}$ складається з двох координат $x_1$ та $x_2$ (тобто, ${\mathbf{X} \in \mathbb{R}^2}$). В ідеальному випадку множина ОДР ${G \in \mathbb{R}^2}$ утворює на площині деяку замкнену область, як показано на Рис.~\ref{pic:linear:example:g_set}. Зрозуміло, що коли обрати будь-яку точку з неї, то такі координати ${\langle x_1, x_2 \rangle}^\top$ є допустимим розв'язком. Допустимих розв'язків існує безкінечна кількість (оскільки ми оперуємо множиною дійсних чисел, яка сама по собі є континуумом), але найоптимальнішим буде той, для якого цінова функція $\varphi(\mathbf{X})$ визначає якнайбільше число. Як можна знайти такий розв'язок графічно?

\illustration[t]
 {../imgs/linear/2d-plain.pdf}
 {ОДР утворює опуклий багатокутник на площині.}
 {pic:linear:example:g_set}

Проаналізуймо цінову функцію. В загальному випадку вона матиме вигляд $\varphi = c_1 x_1 + c_2 x_2$, тобто утворюватиме площину в тривимірному просторі з координат $\langle x_1, x_2, \varphi \rangle$. Це можна уявити як на Рис.~\ref{pic:linear:example:phi_set}. Тоді допустимі розв'язки лежатимуть всередині проєкції ОДР на площину цінової функції. З рисунку добре видно, в яку сторону вона зростає, тож тепер зрозуміло, що точка $\mathbf{X}_1$ є допустимим розв'язком з мінімально можливим $\varphi$, а $\mathbf{X}_5$ -- з максимальним $\varphi$. Тоді обидві точки будуть розв'язками задачі на мінімізацію та максимізацію цінової функції відповідно.

\illustration
 {../imgs/linear/2d-with-phi.pdf}
 {Погляд на ОДР з іншої перспективи. Пунктиром позначено проєкцію $G$ на $\varphi$.}
 {pic:linear:example:phi_set}

Чи існує більш практичний спосіб, без потреби відмальовування тривимірних площин? Оскільки $\varphi$ -- лінійна функція, то за будь-яких $x_1$ та $x_2$ вона є неперервною, і зростає завжди однаково. Тобто, при будь-яких аргументах вектор градієнту завжди буде однакової довжини та спрямований в однаковому напрямку. Це означає, що на звичайному двовимірному малюнку достатньо позначити вектор $\overrightarrow{\mathrm{grad}}\,\varphi$ (як і показано на Рис.~\ref{pic:linear:example:g_set}). Тоді розв'язком задачі на максимізацію буде точка, що лежить якнайдалі у напрямку цього вектору. Аналогічно при мінімізації оптимальна точка розв'язку лежатиме у протилежному напрямку.

\begin{note}
 Читачу також може бути цікаво уявити випадок, коли цінова функція формує не площину, а деяку складну просторову фігуру. Проєкція $G$ на $\varphi$ сформує набір точок $\langle x_1, x_2, \varphi \rangle$, а оптимальним розв'язком буде та, що матиме найменшу координату $\varphi$.
\end{note}

\begin{problem}{problem:linear:gradient}
 Чи можна для розв'язування такої задачі використати метод градієнтного спуску? Яким чином його потрібно модифікувати? Які це дасть переваги? Які можуть виникнути проблеми?
\end{problem}

\begin{problem}{problem:linear:non_convex}
 Чи можна з допомогою системи лінійних рівнянь описати таку ОДР, яка утворюватиме неопуклий багатокутник? Як це працюватиме у вищих вимірах?
\end{problem}

\begin{conclusions}{conclusions:linear:solving}
\begin{itemize}
 \item оптимальний розв'язок може бути розташований в одній з кутових точок \footnote{(англ.) \textit{extreme point}};
 \item кутова точка є оптимальним розв'язком, якщо жодна з сусідніх точок не є оптимальнішою.
\end{itemize}
\end{conclusions}

\illustration
 {../imgs/linear/brewery.pdf}
 {Запаси ресурсів, параметри ви\-роб\-ниц\-тва та прибутковість елю й пива.}
 {pic:linear:problem:brewery}

\subsection{Розв'язування задачі}

Розглянемо деяку специфічну задачу. \textit{Броварня виготовляє ель та пиво. Виробництво кожного з них вимагає певної комбінації кукурудзи, хмелю та ячмінного солоду на 1 умовну одиницю (бочку, партію тощо). Кількість ресурсів обмежена. Кожен продукт має свою ціну. Параметри виробництва показано на Рис.~\ref{pic:linear:problem:brewery}. Потрібно розрахувати оптимальну кількість вирбництва двох продуктів, щоби отримати якнайбільший прибуток.}

Некеровані змінні можна позначити вектором $\mathbf{a} = {\langle 220, 5, 540 \rangle}^\top$ (кількість доступних ресурсів на складі), $\mathbf{b} = {\langle 213, 485 \rangle}^\top$ (прибуток від кожного з товарів) та матрицею $\mathbf{A}$ (\ref{eq:linear:problem:brewery:a}), де $a_{ij}$ позначатиме витрату $i$-ого ресурсу на $j$-ий продукт. Вартість кожного з продуктів визначатиме вектор $\mathbf{c} = {\langle 213, 485 \rangle}^\top$.

\begin{equation}
 \mathbf{A} = \begin{bmatrix}
               3 & 0.1 & 15 \\
               7 & 0.1 & 10
              \end{bmatrix}
 \label{eq:linear:problem:brewery:a}
\end{equation}

Тоді керованою змінною є вектор $\mathbf{X} = \langle x_1, x_2 \rangle^\top$ координати якого позначають скільки бочок елю та пива потрібно виготовити відповідно. Якщо розв'язок лежить в ОДР, мусять виконуватись такі умови:

\begin{itemize}
 \item кількість використаних кукурудзи, хмелю та солоду не повинна перевищувати доступної;
 \item не можна виготовити від'ємну кількість продукції.
\end{itemize}

Кількість, використаної кукурудзи обраховується як ${3 x_1 + 7 x_2}$ (тобто, залежить від того, скільки виготовляється обох видів продукту). Оскільки маємо на неї обмеження, можна скласти нерівність ${3 x_1 + 7 x_2 \leq 220}$, що повинна виконуватись для допустимості розв'язку. Аналогічно складаються решту нерівностей, що утворюють ОДР задачі~(\ref{eq:linear:problem:brewery:g_set}).

\begin{equation}
 \mathbf{X} \in G \Leftarrow \left\{\begin{array}{l}
    3 x_1 + 7 x_2 \leq 220 \\
    0.1 x_1 + 0.1 x_2 \leq 5 \\
    15 x_1 + 10 x_2 \leq 540 \\
    x_1, x_2 \geq 0
 \end{array}\right\}
 \label{eq:linear:problem:brewery:g_set}
\end{equation}

Разом з тим оптимальність будь-якої комбінації $x_1$ та $x_2$ доцільно визначати за кількістю прибутку, що вона приносить. Тому цінова функція набуде вигляду~(\ref{eq:linear:problem:brewery:price}).

\begin{equation}
 \varphi(\mathbf{X}) =
 \mathbf{X} \mathbf{c}^\top =
 213 x_1 + 485 x_2
 \rightarrow \max_{\mathbf{X} \in G}
 \label{eq:linear:problem:brewery:price}
\end{equation}

На Рис.~\ref{pic:linear:problem:brewery:g_set} показано ОДР та градієнт цінової функції. З отриманого рисунку видно, що точка з ОДР, найдалі розташована у напрямку градієнта (а значить у напрямку зростання оптимальності), міститься в координатах $x_1 = 21.067$ та $x_2 = 22.4$. Це і є оптимальним розв'язком задачі.

\illustration
 {../imgs/linear/brewery-feasible.pdf}
 {ОДР задачі на двовимірній площині, що утворюється трьома нерівностями та обмеженнями на додатність $x_1$ і $x_2$.}
 {pic:linear:problem:brewery:g_set}
 
\begin{problem}{problem:linear:le_problem}
 Яким був би оптимальний розв'язок задачі, якби знак \flqq{}$\leq$\frqq{} в ОДР замінити на \flqq$<$\frqq?
\end{problem}

\begin{problem}{problem:linear:graphical_integer}
 Якби $x_1$ та $x_2$ визначали б не умовні одиниці, а вимірювалися б у бочках (тобто, тепер $\mathbf{X} \in \mathbb{Z}^2$), яким чином розв'язок такої задачі можна знайти графічно?
\end{problem}

Як видно, графічний спосіб розв'язку досить зручний і простий. Однак коли результат потрібно отримати з високою точністю, таке роз\-в'я\-зу\-ван\-ня стає дуже складним та непрактичним, не кажучи вже про те, що реальні задачі рідко коли бувають двовимірними. Проте потрібно віддати належне -- графічний спосіб ідеальний для унаочнювання даних.

\begin{problem}{problem:linear:dim_reduction}
 Чи можна якимось чином зменшити вимірність проблеми ${\mathbf{X} \in \mathbb{R}^{> 2}}$, щоби скористатись графічним способом розв'язування?
\end{problem}


\subsection{Крайнощі}

\twocolminipage
 {
  \nofigillustration
   {../imgs/linear/unbounded-g-set.pdf}
   {ОДР складається з однієї нерівності, тому є необмеженою зі сторони від'ємних $x_1$ та $x_2$. Тут можна розв'язати задачу на максимізацію, однак розв'язком мінімізації буде точка ${\langle -\infty, -\infty \rangle}$.}
   {pic:linear:unbounded_g_set}
 }{
  \nofigillustration
   {../imgs/linear/incountable-solutions.pdf}
   {Іноді неможливо визначити точку, що лежить найдалі за напрямком градієнта, оскільки всі точки на деякій лінії мають однакову оптимальність. В такому разі вони всі є оптимальними, і не існує єдиного $\mathbf{X}$.}
   {pic:linear:incountable_solutions}
 }

\illustration[t]
 {../imgs/linear/full-unboundance.pdf}
 {ОДР складається з 4 нерівностей, однак не існує жодної такої області, де вони всі перетиналися б одночасно. Тому $G = \varnothing$.}
 {pic:linear:full_unboundance}

Описані раніше випадки, взагалі кажучи, є ідеальними, а із задачею нам просто пощастило.

Найперша проблема, яку іноді можна отримати -- ОДР не є замкненою, як показано на Рис.~\ref{pic:linear:unbounded_g_set}. В такому разі з тієї сторони, з якої ОДР необмежена, єдиного розв'язку не існує, позаяк до нього можна наближуватись безкінечно. Якщо така відповідь є допустимою, розв'язком можна вважати точку ${\langle \pm \infty, \pm \infty \rangle}$, однак найчастіше подібний результат просто не є адекватним.

Іноді оптимальних розв'язків існує \textit{безкінечна кількість}. Подібне формулювання може заплутати, і створити враження, ніби оптимальними є взагалі всі можливі розв'язки, хоча це не так. Така ситуація продемонстрована на Рис.~\ref{pic:linear:incountable_solutions}. У відповіді до цієї задачі доречно просто описати закон розрахунку оптимальних $x_1$ та $x_2$.

Може так трапитись, що нерівності, з яких складається ОДР, ніде не перетинаються одночасно, як показано на Рис.~\ref{pic:linear:full_unboundance}. В такому разі ОДР порожня, а отже жодного оптимального розв'язку не може існувати за визначенням.

\subsection{Тривимірний випадок}

\illustration
 {../imgs/linear/3d-g-set.pdf}
 {Оскільки така фігура має 7 граней, можна зробити висновок, що вона утворена 7-ома нерівностями. Будь-яка точка $\langle x_1, x_2, x_3 \rangle$ всередині неї є допустимим розв'язком. Зважаючи на напрямок вектора градієнту, точка $\mathbf{X}_2$ є розв'язком задачі на мінімізацію, а $\mathbf{X}_1$ -- на максимізацію цінової функції.}
 {pic:linear:3d:g_set}

Якщо у двовимірному просторі набір лінійних нерівностей може відтинати багатокутник, то у тривимірній області $G$ ми отримаємо багатогранник. Приклад такої фігури показано на Рис.~\ref{pic:linear:3d:g_set}. В цьому випадку читачу може бути складно уявити цінову функцію ${\varphi: \mathbb{R}^3 \rightarrow \mathbb{R}}$, позаяк вона є чотиривимірною, однак сенс залишається той самий: якщо перелік всіх точок фігури посортувати за тим, наскільки \flqq{}далеко\frqq{} вони розташовані в напрямку вектора-градієнта (а він тривимірний), то це одночасно буде перелік, посортований за зростанням оптимальності. Можна ще уявити це як зростання температури, яскравості чи будь-якої іншої простої для розуміння характеристики в певному напрямку.
 
Хоча отримана фігура досить проста на вигляд, малювати площини та визначати їхні перетини від руки насправді дуже складно. У вищих вимірностях проблема стає практично нерозв'язуваною. Тому хороший дослідник потребує більш точних аналітичних методів.

\section{Симплекс-метод}
\label{section:linear:simplex}

\begin{note}
 Математичний апарат -- це лише інструмент для створення алгоритму. Позаяк ним, ймовірно, користуватимуться не тільки дослідники-математики, а й люди інших професій, які не завжди володіють інструментами лінійної алгебри тощо, новий алгоритм може повністю інкапсулювати всі складні математичні поняття -- саме це сталося із симплекс-методом. Тому в нас неодмінно виникнуть деякі суперечності у поняттях в межах самого алгоритму та математичних інструментів.
\end{note}

Симплекс-метод -- це інструмент, яким можна аналітично розв'язувати багатовимірні задачі ЛП за умови, що вони приведені до деякого стандартного вигляду. Його головна ідея природно випливає з висновків на с.~\pageref{conclusions:linear:solving}:

\begin{itemize}
 \item якщо оптимальний розв'язок розташований в одній з кутових точок, потрібно отримати список всіх їхніх координат;
 \item опісля обраховуємо значення цінової функції $\varphi$ у всіх точках;
 \item обираємо точку з найбільшим $\varphi$, тобто найбільшою оптимальністю -- розв'язок знайдено.
\end{itemize}

\begin{problem}{problem:linear:infite_optimum}
 Якщо дійсно реалізовувати таку ідею -- як визначити випадок, коли весь відрізок між двома точками визначає оптимальні розв'язки? Як узагальнити це для багатовимірних просторів?
\end{problem}

Насправді це не зовсім вдале рішення, бо в промислових умовах задачі ЛП можуть мати тисячі різних рівнянь, тому часові та обчислювальні затрати на те, щоби визначити, які з них утворюють між собою перетини, та обчислення їхніх координат
, будуть просто неадекватними. Натомість ми трохи ускладнюємо процес:

\begin{itemize}
 \item починаємо обхід фігури з деякого початкового рішення (\textbf{опорного плану}\footnote{(англ.) \textit{basic feasible solution}}), яке точно є допустимим -- наприклад $\mathbf{X}_0 = {\langle 0, 0, \ldots \rangle^\top}$\footnote{Пізніше читач дізнається, що така точка завжди буде допустимим рішенням, якщо умова задачі задана у канонічному вигляді.};
 \item аналізуємо цінову функцію: якщо збільшення якоїсь зі змінних призведе до її зростання, то збільшуємо її, наскільки можливо;
 \item використовуємо при цьому такий базис простору, в якому достатньо збільшувати лише одну координату, щоби потрапити в сусідню точку ОДР;
 \item перераховуємо коефіцієнти цінової функції так, щоби вона показувала, які зі змінних можна ще збільшувати;
 \item якщо зміна значень всіх змінних призведе до спадання $\varphi$, то найоптимальніший розв'язок вже знайдено.
\end{itemize}

Для реалізації цього алгоритму використовується апарат лінійної алгебри. Дуже часто його залишають без пояснення, тож допитливий дослідник отримує лише інструкцію до виконання -- незрозумілу та дуже абстрактну. Щоби уникнути такої ситуації, ми дослідимо математичний апарат, який лежить в основі алгоритму, аналізуючи концепти, які спершу, можливо, видаватимуться зовсім непов'язаними один з одним. Проте пізніше читач по-справжньому оцінить їхню елеґантність.

\subsection{Математичний апарат}

\subsubsection{Люзові змінні}

Будь яку лінійну нерівність $f(x_1, \ldots) \leq b$ можна перетворити у рівність $f(x_1, \ldots) + s = b$. Тоді при ${s=0}$ ми отримаємо лінію, яка лежить на межі області нерівності. При збільшенні $s$ вона буде паралельно переноситись все далі від цієї межі, аж доки при $s=b$ не пройде через центр координат. Отже, при всіх $s \geq 0$ отримане рівняння описуватиме всі можливі точки $\langle x_1, x_2, \ldots \rangle$ всередині області нерівності. Це показано на Рис.~\ref{pic:linear:slack_inequality_leq} та Рис.~\ref{pic:linear:slack_inequality_geq}. Такі змінні $s$ називається \textbf{люзовими}\footnote{(англ.) \textit{slack variables} для нерівностей зі знаком~\flqq{}$\leq$\frqq{}, \textit{surplus variables} для нерівностей~\flqq{}$\geq$\frqq{}.}.

\begin{figure*}
 \centering
 \begin{minipage}[t]{.47\textwidth}
  \includegraphics{../imgs/linear/slack-inequality-leq.pdf}
  \caption{Нерівність $x_1 + x_2 \leq 4$ утворює область, межу якої можна описати рівнянням $x_1 + x_2 + s = 4$ при $s=0$. При $s=b=4$ ця лі\-нія проходить через центр координат.}
  \label{pic:linear:slack_inequality_leq}
 \end{minipage}\qquad
 \begin{minipage}[t]{.47\textwidth}
  \includegraphics{../imgs/linear/slack-inequality-geq.pdf}
  \caption{Для того, щоби отримати такий самий ефект для нерівностей \flqq{}$\geq$\frqq{}, змінну $s$ потрібно включити у рівняння прямої зі знаком~\flqq{}$-$\frqq{}.}
  \label{pic:linear:slack_inequality_geq}
 \end{minipage}
\end{figure*}

Проаналізуймо нерівність $f(x_1, x_2, \ldots) \leq b$, якою зазвичай задаються умови на ОДР задачі лінійного програмування. Її можна переписати так:
 
\[
  \begin{array}{l@{\;}rllr}
   f(x_1, x_2, \ldots) &  \leq b  &                          & \equiv & \\
   f                   & + s\,= b & \forall s > 0            & \equiv & \text{(1)} \\
   s = b - f           &          & \forall x_1, x_2, \ldots &        & \text{(2)}
  \end{array}
 \]

На кроці (1) ми ввели люзову змінну, а на кроці (2) -- перенесли $f$ в праву частину рівняння. Оскільки $b$ завжди позначає кількість доступного ресурсу, а $f$ -- функція, що обраховує кількість використаних (перемножуючи $x_1, x_2, \ldots$ на відповідні $a_{n1}, a_{n2}, \ldots$), то логічно, що $s$ можна інтерпретувати як \textit{кількість невикористаних ресурсів}.

\subsubsection{Система рівнянь з люзовими змінними}

Нехай маємо таку систему нерівностей:

\[
 \left\{
  \begin{array}{l}
   a_{11} x_1 + a_{12} x_2 \leq b_1 \\
   a_{21} x_1 + a_{22} x_2 \geq b_2
  \end{array}
 \right. .
\]

Введемо змінну $\delta_n$. Якщо $n$-на нерівність в системі має знак \flqq{}$\leq$\frqq{}, то $\delta_n=1$, а якщо навпаки -- то $\delta_n=-1$. Тепер систему нерівностей можна переписати як систему рівностей, а також отримати аналогічний запис у матрично-векторному-вигляді.

\begin{figure}[!h]
 \center
 \includegraphics{../imgs/linear/converting-to-matrix-vector.pdf}
\end{figure}

Ще коротший запис -- $\mathbf{A} \mathbf{X} + \mathbf{\delta} \mathbf{s} = \mathbf{b}$. Аналогічно можна представити систему нерівностей будь-якої вимірності.

\begin{problem}{problem:linear:convex_statement}
 Нехай $\mathbf{\delta}$ -- одинична матриця. Який висновок можна зробити про систему нерівностей?
\end{problem}

\begin{problem}{problem:linear:canonical_statement}
 Нехай всі нерівності з ОДР мають знак \flqq{}$\leq$\frqq{}, і $\forall \langle x_1, \ldots, x_n \rangle \in G \; \forall i: x_i \geq 0$. Чи можна стверджувати, що точка центру координат $\langle 0, 0, \ldots \rangle \in G$?
\end{problem}

\begin{problem}{problem:linear:new_slack}
 Маємо систему з люзовими змінними за прикладом, що вище. Змінним $x_1$ та $x_2$ присвоєно деякі значення так, що вони визначають розв'язок системи. Зрозуміло, що при зміні їхнього значення, $s_1$ та $s_2$ потрібно перерахувати, щоби рівності знову справджуватись. Якою буде формула для обрахунку нових люзових змінних?
\end{problem}

\begin{problem}{problem:linear:new_x1x2}
 Аналізуємо ту саму систему рівнянь. Нехай при значеннях $s_1 = s_2 = 0$ система має деякий розв'язок $\mathbf{X} = \langle x_1, x_2 \rangle$, як показано на рисунку нижче. Очевидно, що якщо змінити значення $s_1$, то розв'язок системи теж зміниться. Як знайти його?
 \center
 \includegraphics{../imgs/linear/simple-slack-solution.pdf}
\end{problem}

\subsubsection{Оцінка росту функції}
\label{section:linear:phi_increase_evaluation}

Нехай маємо цінову функцію у загальному вигляді $\varphi = c_1 x_1 + c_2 x_2$. Уявімо також, що на площині визначена деяка точка ${\langle x_1, x_2 \rangle}$. Дозволено збільшувати одну з її координат. Яку з них доцільно обрати таку, щоби значення $\varphi$ зростало якнайшвидше?

\flqq{}Найвигіднішу\frqq{} координату можна обрати як за допомогою частинного диференціювання, так і користуючись простою арифметичною логікою: у значення $\varphi$ найбільший вклад вносить така змінна $x_i$, біля якої стоїть найбільший коефіцієнт $c_i$. Приклад конкретної задачі показано на~Рис.~\ref{pic:linear:price_problem_1}.

\illustration
 {../imgs/linear/price-problem1.pdf}
 {Ізолініями позначено значення фукнції $\varphi = 2 x_1 + 5 x_2$. Видно, що збільшення координати $x_2$ дає більший зріст $\varphi$, ніж збільшення $x_1$ на те саме значення. Це стається тому, що $\dfrac{\partial\varphi}{\partial x_1} > \dfrac{\partial\varphi}{\partial x_2}$, або по-іншому: $c_1 > c_2$.}
 {pic:linear:price_problem_1}

\begin{problem}{problem:linear:steepest_point}
 З точки $\langle x_0, y_0 \rangle$ можна перейти до $\langle x_1, y_1 \rangle$ або $\langle x_2, y_2 \rangle$, при чому відстань від $\langle x_0,y_0 \rangle$ до $\langle x_1,y_1 \rangle$ така сама, як і до $\langle x_2,y_2 \rangle$. Цінова функція задана як $\varphi = x c_1 + y c_2$. Чи можна за рисунком оцінити, перехід до якої точки призведе до найбільшого зростання $\varphi$? Чи можна також зробити це аналітично, не обраховуючи значення $\varphi$? Якщо можна, то як? Чи працюватиме це для багатовимірних просторів?
 \center
 \includegraphics{../imgs/linear/steepest-point.pdf}
\end{problem}

\subsubsection{Люзові змінні як базис}

\twocolminipage
 {
  \nofigillustration
   {../imgs/linear/slack-replace-x2.pdf}
   {Нові осі теж створюють двовимірний простір -- щоправда, трохи \flqq{}спотворений\frqq. Вздовж всієї лінії змінюється лише координата $x_1$, а $s_1$ залишається сталою.}
   {pic:linear:slack_replace_x2}
 }{
  \nofigillustration
   {../imgs/linear/slack-line-on-x1x2.pdf}
   {Той самий шлях у базисі ${\langle x_1, x_2 \rangle}$ вимагає зміни двох координат $x_1$ та $x_2$ одночасно.}
   {pic:linear:slack_line_on_x1x2}
 }

Погляньмо ще раз на Рис.~\ref{pic:linear:slack_inequality_leq}. Можна уявити, що $s$ змінюється по деякій діагональній осі. Спробуймо провести її на графіку, викинувши якусь іншу, наприклад, $x_2$, як на Рис.~\ref{pic:linear:slack_replace_x2}. Така дія називається \textbf{переходом до нового базису}\footnote{(англ.) \textit{pivoting}}. Використовуючи нові осі, можна представити будь-яку точку двовимірного простору. Таку систему координат ми називаємо \flqq{}простором з базисом ${\langle x_2, s \rangle}$\frqq{} Якщо в ньому рухати якусь точку, змінюючи всього одну координату, то легко побачити, що аналогічний рух на графіку з базисом ${\langle x_1, x_2 \rangle}$ вимагатиме зміни двох координат одночасно, як на Рис.~\ref{pic:linear:slack_line_on_x1x2}.

Чому це може бути зручно? Справа в тім, що в новому базисі ${\langle x_1, s \rangle}$ моделювати рух по потрібній лінії досить просто -- ми ж змінювали лише одну змінну. Водночас, завжди є можливість повернутись назад, до звичного базису ${\langle x_1, x_2 \rangle}$, отримавши нові координати, які інакше довелося б розраховувати, наприклад, з рівняння прямої.

\begin{note}
  Операція заміни базису є тривіальним завданням в лінійній алгебрі. Нові координати можуть бути обчислені за допомогою спеціальних матриць переходу, або з системи рівнянь.
\end{note}

\begin{problem}{problem:linear:circular_space}
 Чи можна створити такий простір $O$, в якому рух по прямій перетворювався би в рух по колу в просторі $R$? Якими будуть формули переходу? Яку мінімальну вимірність повинні мати такі простори? Чи є таке перетворення лінійним?
\end{problem}

\illustration
 {../imgs/linear/slack-figure1.pdf}
 {Три рівняння при $s_{1,2,3}=0$ та осі $x_1$ і $x_2$ замикають область опуклого п'ятникутника. На перетинах усіх ліній позначено точки ${\mathbf{X}_0 \ldots \mathbf{X}_4}$. Для простоти зображення відповідні осі $s_1$, $s_2$ та $s_3$ не показано.}
 {pic:linear:slack_figure1}

Нехай ми маємо, наприклад, систему рівнянь таку, як показана на Рис.~\ref{pic:linear:slack_figure1}. Можна побачити, що перебуваючи в базисі ${\langle x_1, s_1 \rangle}$, і змінюючи лише координату $x_1$ при $s_1 = 0$ можна потрапити з точки $\mathbf{X}_1$ до $\mathbf{X}_2$. Для того, щоби здійснити наступний перехід до $\mathbf{X}_3$, зручно включити в базис $s_2$. Тепер він складатиметься з трьох змінних, і оскільки ми працюємо з двовимірним простором, одну з них можна \flqq{}викинути\frqq{}. Зазвичай \flqq{}викидають\frqq{} ту змінну, значення якої ми вже змінили раніше.

\begin{note}
 Позначатимемо надалі перехід від однієї точки до іншої знаком \flqq{}$\subarrow{\langle \cdot, \cdot \rangle}$\frqq \, -- стрілкою, над якою позначено базис, у якому зручно моделювати таке переміщення.
\end{note}

\begin{note}
Читач вже знає, що при збільшенні $s_i$ лінія рівняння з відповідною люзовою змінною наближатиметься до центру координат. Якщо ж навпаки деяке $s_i < 0$, то така лінія виходить за межі ОДР. Тому, щоби уникнути такої ситуації, вводячи люзові змінні, ми повинні створити ще одне обмеження ОДР --

\[
 \forall i: s_i \geq 0.
\]
\end{note}

Отже, рух вздовж фігури, що окреслена заданою системою рівнянь, матиме такий вигляд:
$
\mathbf{X}_0
\subarrow{\langle x_1, x_2 \rangle}
\mathbf{X}_1
\subarrow{\langle x_1, s_1 \rangle}
\mathbf{X}_2
\subarrow{\langle s_2, s_1 \rangle}
\mathbf{X}_3
\subarrow{\langle s_2, s_3 \rangle}
\mathbf{X}_4
\subarrow{\langle x_1, s_3 \rangle}
\mathbf{X}_0
$. Як видно, така техніка дозволяє навіть, збільшуючи $s_3$ і утримуючи $x_1 = 0$, потрапити у точку $\mathbf{X}_0$, тобто, фактично, зробити крок назад.

\begin{conclusions}{conclusions:linear:simplex:pivoting}
 Якщо уважно прослідкувати за поданим рухом, то можна помітити, що змінна, яка входить в новий базис -- це завжди та, що визначає лінію, яка перетинається з траєкторією руху найперша. До прикладу: якщо ми рухаємось вздовж осі $x_2$ в напрямку зростання, то спочатку ми перетинаємо лінію $s_1 = 0$, а тоді -- $s_2 = 0$. Отже в новий базис замість $x_2$ (яку ми вже змінювали раніше) увійде $s_1$.
\end{conclusions}

Якщо повторити цю проблему у тривимірному, або в будь-якому $n$-вимірному просторі, то базис переходу міститиме три, або $n$ змінних відповідно. Такі процеси дуже важко, або взагалі неможливо візуалізувати, саме тому так важливо створити хорошу аналітичну модель.

\subsubsection{Оцінка росту функції в новому базисі}

Зрозуміло, що в процесі ходу алгоритму ми переходимо від якогось $\mathbf{X}_a$ до $\mathbf{X}_b$ не просто так, а лише тому, що $\varphi(\mathbf{X}_b) > \varphi(\mathbf{X}_a)$, і ці дві точки є сусідніми. Читач вже знає, що для оцінки того, значення якої змінної варто змінювати, потрібно просто порівняти коефіцієнти $c_i$. Однак що робити, коли цінова функція задана як $\varphi(x_1, x_2)$, а ми перебуваємо в базисі, наприклад, $\langle x_1, s_1 \rangle$? Маючи систему рівностей таку саму, як приведено на Рис.~\ref{pic:linear:slack_figure1}, можна виразити $x_2$ з першого рівняння. Тоді отримуємо:

\begin{equation}
 \begin{array}{lcc}
  a_{11} x_1 + a_{12} x_2 + s_1 = b_1          & \equiv      & \text{(1)} \\ [8pt]
  x_2 = \dfrac{b_1 - s_1 - a_{11} x_1}{a_{12}} & \text{;}    & \text{(2)} \\ [8pt]
  \varphi(x_1, x_2) = c_1 x_1 + c_2 x_2        & \Rightarrow &            \\ [8pt]
  \varphi(x_1, s_1) = c_1 x_1 + c_2 \left(
    \dfrac{b_1 - s_1 - a_{11} x_1}{a_{12}}
  \right)                                      & \equiv      & \text{(3)} \\ [8pt]
  \varphi(x_1, s_1) =
  c_2 a_{12} c_1 x_1 - c_2 b_1 - c_2 s_1 - c_2 a_{11} x_1  & &
 \end{array}
 \label{eq:linear:simplex:slack_solving}
\end{equation}

Тепер ми отримали цінову функцію, яка залежить від аргументів нового базису. При чому, вона є лінійною. Тому тепер для оцінки оптимального напрямку достатньо лише порівняти коефіцієнти при відповідних змінних. Аналогічний процес відбуватиметься при переході між будь-якими кутовими точками фігури.

\subsubsection{Базис симплекс-методу}

Раніше, для того, щоби вивести з базису змінну $x_2$, і ввести $s_1$, ми відшукали в системі рівнянь таке, що містить $s_1$ лише один раз (\ref{eq:linear:simplex:slack_solving}.1), розв'язали його відносно змінної, яку виводимо (\ref{eq:linear:simplex:slack_solving}.2), і тоді замінили отриманим виразом виведену змінну (\ref{eq:linear:simplex:slack_solving}.3). Для того, щоби така операція була завжди зручною, можна підтримувати систему рівнянь у такому вигляді, щоби всі рівняння були розв'язані відносно змінної, яка може бути введена в базис. Наприклад:

\begin{equation}
 \begin{array}{r@{\;}r@{\;}r}
  s_1               = & b_1 - a_{11} x_1 - & a_{12} x_2 \text{,} \\
  s_2               = & b_2 - a_{21} x_1 - & a_{22} x_2 \text{,} \\
  s_3               = & b_3 - a_{31} x_1 - & a_{32} x_2 \text{,} \\
  \varphi(x_1, x_2) = &          c_1 x_1 + &    c_2 x_2 \text{.}
 \end{array}
 \label{eq:linear:simplex:canonical_slack_2dim3eq}
\end{equation}

Читачу, що вже має розв'язок Проблеми №\arabic{chapter}.\ref{problem:linear:new_slack}, така форма запису системи рівнянь видається знайомою. Ми змогли через три змінні виразити всі рівняння: це тому, що кожна змінна трапляється лише в одному з них, і лише один раз. За таку особливість $s_1$, $s_2$ та $s_3$ називають \textbf{базисними змінними}. Цей момент може бути дуже незрозумілим, позаяк до цього ми називали \flqq{}базисом\frqq{} змінні, через які виражена цінова функція, і змінюючи які, нам зручно рухатись вздовж фігури ОДР. Така суперечність у назвах виникла тому, що алгоритм переназиває деякі речі математичного апарату -- нам же, задля зрозумілості, потрібно якось розмежувати ці поняття. Тому надалі використовуймо поняття \textbf{просторового базису} та \textbf{симплекс-базису}.

\begin{note}
 \textbf{Симплекс-базис} -- сукупність змінних, кожна з яких трапляється лише в одному з рівнянь системи, і з додатнім знаком. В межах симплекс-методу їх називають просто \textbf{базисом}. На початку розв'язку задачі він може складатися лише з люзових змінних.

 \textbf{Просторовий базис} -- змінні, через які виражена цінова функція, і які ми будемо змінювати. В межах симплекс-методу їх називають \textbf{вільними змінними}.
\end{note}

Тепер, якщо нам потрібно, наприклад, вивести з просторового базису змінну $x_1$, а ввести $s_3$, ми виконуємо такі кроки:

\begin{enumerate}
 \item знаходимо рівняння, яке починається з \flqq{}$s_3=$\frqq{};
 \item розв'язуємо його відносно $x_1$, і отримуємо $$x_1 = \dfrac{s_3 - b_3 + a_{32} x_2}{-a_{31}};$$
 \item у кожному з рівнянь системи та ціновій функції замінюємо $x_1$ на отриманий дріб, і маємо нову систему;
 \item для зручності приводимо кожен з записів до лінійного вигляду.
\end{enumerate}

Жодне зі значень змінних $x_1, x_2, s_1, \ldots$ при цьому не змінюється, але ми отримуємо запис системи рівнянь у зовсім іншому вигляді -- такому, що збільшуючи лише одну координату просторового базису, і відповідно перераховуючи змінні симплекс-базису, ми можемо потрапити у сусідню точку фігури ОДР. Таким чином, змінюючи базиси та збільшуючи значення просторових змінних, ми поступово наближатимемось до оптимального розв'язку задачі.

\begin{note}
 Позначатимемо надалі симплекс-базис як $\mathbf{B}_S$, а просторовий базис -- $\mathbf{B}_A$. Позначення $\mathbf{B}_S \subarrow{a} \mathbf{B}_A$ означатиме перехід деякої змінної $a$ з симплекс-базису у просторовий.
\end{note}

\subsubsection{Межа збільшення змінних просторового базису}

Ми вже знаємо, що збільшуючи деяку змінну просторового базису, можна потрапити у сусідню точку фігури. Однак ми досі не відповіли на дуже важливе запитання: а наскільки потрібно збільшувати цю змінну? Розгляньмо детальніше Рис.~\ref{pic:linear:slack_figure1}. Нехай на деякій ітерації ми перебуваємо в точці $\mathbf{X}_0$ і маємо просторовий базис $\langle x_1, x_2 \rangle$. Це означає, що кожне з рівнянь системи в цей момент розв'язане відносно відповідної змінної симплекс-базису $\langle s_1, s_2, s_3 \rangle$ -- так, як у системі~(\ref{eq:linear:simplex:canonical_slack_2dim3eq}).

\illustration
 {../imgs/linear/slack-figure-zoom-x1x2.pdf}
 {Рухаючись від точки $\mathbf{X}_0$, ми можемо збільшувати $x_2$, допоки не досягнемо точки $\mathbf{X}_{s_1 \cap x_1}$, в якій $x_1 = s_1 = 0$, або точки $\mathbf{X}_{s_2 \cap x_1}$, де $x_1 = s_2 = 0$. Якщо підставити відомі $x_1$, $s_1$ та $s_2$ в рівняння відповідних прямих, то можна знайти координати $x_2$ обох точок. Аналогічно змінну $x_1$ можна збільшувати, допоки ми не досягнемо точок $\mathbf{X}_{s_3 \cap x_2}$ або $\mathbf{X}_{s_2 \cap x_2}$, координати $x_1$ яких можна знайти з відповідних рівнянь прямих.}
 {pic:linear:slack_figure_zoom_x1x2}

Якщо подивитись на деталізованішу інтерпретацію на Рис.~\ref{pic:linear:slack_figure_zoom_x1x2}, то можна побачити, що кожне рівняння системи визначає лінії, які перетинатимуть траєкторію руху, якщо ми збільшуватимемо одну зі змінних просторового базису. Нехай, наприклад, ми хочемо збільшувати $x_1$, утримуючи $x_2 = 0$. Тоді з системи рівнянь ми можемо отримати межі збільшення $x_1$, такі щоби виконувалась умова з ОДР $\forall i: s_i \geq 0$:

\[
\left\{\begin{array}{l}
  s_1 = b_1 - a_{11} x_1 - a_{12} \cdot 0 \\
  s_2 = b_2 - a_{21} x_1 - a_{22} \cdot 0 \\
  s_3 = b_3 - a_{31} x_1 - a_{32} \cdot 0
\end{array}\right.
\overset{s_{1, 2, 3} \geq 0}{\Rightarrow}
\left\{\begin{array}{l}
  x_1 \leq \dfrac{b_1}{a_{11}} \\[4pt]
  x_1 \leq \dfrac{b_2}{a_{21}} \\[4pt]
  x_1 \leq \dfrac{b_3}{a_{31}}
\end{array}\right..
\]



Залишається лише присвоїти $x_1$ таке значення, щоби задовільнити всі отримані нерівності, і перерахувати всі змінні симплекс-базису -- читач уже вміє це робити, якщо має розв'язок Проблеми №\arabic{chapter}.\ref{problem:linear:new_slack}.

\begin{problem}{problem:linear:zero_in_matrix}
 Нехай у системі ми маємо рівняння $s_1 = b_1 - a_{11} x_1 - a_{12} x_2$, при чому $a_{11} = 0$. Тобто, ми можемо отримати нерівність $x_1 \leq \dfrac{b_1}{a_{11}}$, у якій буде ділення на нуль. Що тоді можна сказати про таку межу? Які висновки можна зробити про лінію $s_1 = 0$ на графіку?
\end{problem}

\begin{conclusions}{conclusions:linear:simplex:increase_boundaries}
 Змінні симплекс-базису, прирівняні до нуля завжди визначають лінії, що перетинають траєкторію руху при зміні значення однієї зі змінних просторового базису.
\end{conclusions}

Для зрозумілості спробуймо також проаналізувати перехід $\mathbf{X}_1 \subarrow{\langle x_1, s_1 \rangle} \mathbf{X}_2$, як показано на Рис.~\ref{pic:linear:slack_figure_zoom_x1s1}. Оскільки просторовий базис -- $\langle x_1, s_1 \rangle$, то це означає, що симплекс базис складається зі змінних $x_2$, $s_2$, та $s_3$. Дійсно, якщо утримувати $s_1 = 0$, збільшуючи $x_1$, спочатку ми перетнемо лінію $s_2 = 0$ у точці $\mathbf{X}_2$, тоді -- $s_3 = 0$ у $\mathbf{X}_{s_1 \cap s_3}$, і наостанок -- $x_2 = 0$. Якщо ж утримувати $x_1 = 0$, збільшуючи $s_1$, то найпершою ми перетнемо лінію $x_1 = 0$. Для того, щоби перетнути $s_2 = 0$ у точці $\mathbf{X}_{x_1 \cap s_2}$, змінну $s_1$ доведеться навпаки зменшувати.

\illustration
 {../imgs/linear/slack-figure-zoom-x1s1.pdf}
 {Перехід $\mathbf{X}_1 \longrightarrow \mathbf{X}_2$ у базисі $\langle x_1, s_1 \rangle$ з Рис.~\ref{pic:linear:slack_figure1}. Щоби не перевантажувати рисунок, сюди не додана нова вісь $s_1$ замість $x_2$.}
 {pic:linear:slack_figure_zoom_x1s1}

\subsubsection{Канонічна постановка задачі}

Ми вже знаємо, що умова задачі лінійного програмування зазвичай задається сукупністю нерівностей. Але читач міг помітити, що насправді ми ніколи не працюємо з самими нерівностями безпосередньо -- дійсно, нас не цікавлять точки, що містяться всередині ОДР. Натомість ми аналізуємо лише її межі, рівності, якими вона задана. Окрім того, якщо в умові задачі потрібно максимізувати $\varphi$, ми можемо бути точно певні, що пошук розв'язку слід починати з точки з якнайменшими допустимими $x_i$, і найчастіше це буде точка початку координат. Тепер, оскільки це настільки досліджений та зручний тип задач, можна ввести поняття \textbf{канонічної умови задачі}\footnote{(англ.) \textit{canonical form}}, яку визначимо як~(\ref{eq:linear:simplex:canonical}). Тобто, неформально кажучи, в \flqq{}канонічній умові\frqq{} ОДР складається тільки з рівностей, і цінову функцію завжди потрібно максимізовувати.

\begin{equation}
 \begin{array}{rl}
  \text{оптимізувати}  & \varphi = \mathbf{c}^\top \mathbf{X} \rightarrow \max \\
  \text{з обмеженнями} & \mathbf{A} \mathbf{X} = \mathbf{b},\; \forall i: x_i \geq 0, \\
  \text{де}            & \mathbf{c}, \mathbf{X} \in \mathbb{R}^n, \; \mathbf{b} \in \mathbb{R}^m, \\
                       & \mathbf{A} \in \mathbb{R}^{n \times m}.
 \end{array}
 \label{eq:linear:simplex:canonical}
\end{equation}

\begin{note}
 Окрім цього, якщо всі люзові змінні мають додатній знак, то $G \neq \varnothing \Rightarrow \mathbf{0} \in G$ (з розв'язку Проблеми №\arabic{chapter}.\ref{problem:linear:canonical_statement}). Цей факт дозволяє нам завжди брати за початковий опорний план точку $\mathbf{X}_0 = \langle 0, 0, \ldots \rangle^\top$.
\end{note}

\subsection{Аналітичне розв'язування}

Тепер спробуймо використати всі можливості створеного математичного апарату, розв'язуючи задачу~(\ref{eq:linear:simplex:example_task1}). Її графічна інтерпретація показана на Рис.~\ref{pic:linear:simplex:example_task1:iter0}.

\begin{equation}
 \begin{array}{rl}
  \text{оптимізувати}  & \varphi = 2 x_1 + 3 x_2 \rightarrow \max \\
  \text{з обмеженнями} & 2 x_1           + \phantom{3} x_2 \leq 4; \\
                       & \phantom{2} x_1 + 3           x_2 \leq 4; \\
  \text{при}           & x_1, x_2 \geq 0.
 \end{array}
 \label{eq:linear:simplex:example_task1}
\end{equation}

\illustration
 {../imgs/linear/simplex-task1-graph1.pdf}
 {Ілюстрація задачі~(\ref{eq:linear:simplex:example_task1}).}
 {pic:linear:simplex:example_task1:iter0}

\subsubsection{Приведення до канонічного вигляду}

Тепер, щоби привести цю задачу до канонічного вигляду, потрібно перетворити нерівності у рівності з допомогою люзових змінних. Ми вже знаємо, що для нерівностей зі знаком \flqq{}$\leq$\frqq{} люзові змінні повинні бути додатними. Тому ми отримуємо таку умову:

\[
 \left\{
  \begin{array}{r@{\;}r@{\;}r@{\;}r@{\;}r@{\;}l@{\;}l@{\;}l}
   2 x_1 & + &   x_2 & + & s_1 &     &     & = 4  \\
     x_1 & + & 3 x_2 & + &       & + & s_2 & = 4
  \end{array}
 \right..
\]

Враховуючи, що $x_1, x_2, s_1, s_2 \geq 0$, отримана умова є канонічною, оскільки $\varphi \rightarrow \max$, і її можна інтерпретувати як

\[
 \begin{bmatrix}
  2 & 1 & 1 & 0 \\
  1 & 3 & 0 & 1
 \end{bmatrix}
 \begin{bmatrix}
  x_1 \\ x_2 \\ s_1 \\ s_2
 \end{bmatrix} =
 \begin{bmatrix}
  4 \\ 4
 \end{bmatrix}
 \equiv
 (\mathbf{A} \mathbf{X} = \mathbf{b}).
\]

Оскільки функція $\varphi$ виражена через змінні $x_1$ та $x_2$, ми маємо симплекс-базис $\langle s_1, s_2 \rangle$ і просторовий базис $\langle x_1, x_2 \rangle$. Розв'яжімо систему через змінні симплекс-базису:

\[
 \left\{
 \begin{array}{l}
  s_1 = 4 - 2 x_1 - \phantom{3} x_2  \\
  s_2 = 4 - \phantom{2} x_1 - 3 x_2
 \end{array}
\right..
\]

Початковий розв'язок задачі -- $$\mathbf{X}_0 = \langle x_1, x_2, s_1, s_2 \rangle^\top = \langle 0, 0, 4, 4 \rangle^\top,\; \varphi(\mathbf{X}_0) = 0 \text{.}$$

\subsubsection{Ітерація №1}

Як можна його покращити? З аналізу цінової функції $\varphi = 2 x_1 + 3 x_2$ зрозуміло, що найвигідніше збільшувати змінну $x_2$, оскільки $c_2 > c_1$. Проаналізуймо, як змінні $s_1$ та $s_2$ залежать від $x_2$:

\[
\left\{
\begin{array}{l}
 s_1 = 4 - \phantom{3} x_2 \\
 s_2 = 4 - 3 x_2
\end{array}
\right.
\]

Для того, щоби зберігалась умова $s_1, s_2 \geq 0$, змінна $x_2$ має відповідати таким умовам:

\[
 \left\{\begin{array}{ll}
  x_2 \leq 4,             & \text{щоби } s_1 \geq 0; \\[8pt]
  x_2 \leq \dfrac{4}{3},  & \text{щоби } s_2 \geq 0.
 \end{array}\right.
\]

Отже, найбільше можливе значення $x_2 = \dfrac{4}{3}$. Нові значення просторового базису -- $x_1 = 0$ та $x_2 = \dfrac{4}{3}$. Значення симплекс-базису можна обчислити з системи:

\[
 \left\{\begin{array}{l}
  s_1 = 4 - 2 \cdot 0 - \dfrac{4}{3} = \dfrac{8}{3} \\[8pt]
  s_2 = 4 - 0 - 3 \cdot \dfrac{4}{3} = 0
 \end{array}\right.
\]

Маємо новий, \flqq{}покращений\frqq{} розв'язок -- $$\mathbf{X}_1 = \langle x_1, x_2, s_1, s_2 \rangle^\top = \left\langle 0, \dfrac{4}{3}, \dfrac{8}{3}, 0 \right\rangle^\top,\; \varphi(\mathbf{X}_1) = 4 \text{.}$$

Оскільки ми збільшували змінну $x_2$ до межі, яку визначає лінія $s_2$, то $\mathbf{B}_A \subarrow{x_2} \mathbf{B}_S$ і $\mathbf{B}_S \subarrow{s_2} \mathbf{B}_A$. Графічно це можна уявити так, як показано на Рис.~\ref{pic:linear:simplex:example_task1:iter1}.

\subsubsection{Ітерація №2}

\illustration
 {../imgs/linear/simplex-task1-graph2.pdf}
 {Утримуючи $x_1 = 0$, і збільшуючи $x_2$, ми перетинаємо спочатку лінію $s_2 = 0$ у точці $x_2 = 1.33 = \dfrac{4}{3}$, а тоді -- $s_1 = 0$ у точці $x_2 = 4$. З рисунка видно, що та лінія, яку ми перетинаємо найперше, формує межу фігури ОДР -- $s_2 = 0$. Тобто, для того, щоби отримати наступну кутову точку, потрібно рухатись саме вздовж неї, а отже в наступній ітерації зручно включити $s_2$ у просторовий базис, виключивши якусь іншу змінну натомість. Зазвичай ми виключаємо ту змінну, значення якої вже змінювали -- у цьому випадку $x_2$.}
 {pic:linear:simplex:example_task1:iter1}

Щоби отримати новий базис, ми застосуємо такі перетворення до системи рівнянь ОДР:

\[
\begin{split}
 (s_2 = 4 - x_1 - 3 x_2) \equiv
 \left(x_2 =  \dfrac{s_2 - 4 + x_1}{-3}\right) \Rightarrow \\[8pt]
 \left\{
  \begin{array}{l@{\;}l@{\;}l@{\;}l@{}l@{}l@{\;}l@{}l}
   s_1 &= 4& - & 2&x_1 &- & &\left(\dfrac{4}{3} - \dfrac{1}{3} x_1 - \dfrac{1}{3} s_2\right) \\[8pt]
   x_2 &= \dfrac{4}{3} &- &\dfrac{1}{3} &x_1 &- &\dfrac{1}{3} &s_2
  \end{array}
 \right. \equiv
 \left\{
  \begin{array}{l@{\;}l@{\;}l@{\;}l@{}l@{}l@{\;}l@{}l}
   s_1 &= \dfrac{8}{3} & - & \dfrac{5}{3} &x_1 &+ &\dfrac{1}{3} & s_2 \\[8pt]
   x_2 &= \dfrac{4}{3} &- &\dfrac{1}{3} &x_1 &- &\dfrac{1}{3} &s_2
   \text{.}
  \end{array}
 \right.
\end{split}
\]
 
Тепер ми отримали систему з просторовим базисом $\langle x_1, s_2 \rangle$ та симплекс-базисом $\langle s_1, x_2 \rangle$. Аналогічно з ціновою функцією:

\[
\begin{split}
  \varphi = 2 x_1 + 3 x_2 = \\
  2 x_1 + 3 \left(\dfrac{4}{3} - \dfrac{1}{3} x_1 - \dfrac{1}{3} s_2\right) = \\
  x_1 - s_2 + 4
  \text{.}
\end{split}
\]

Тепер, коли ми маємо нову цінову функцію, можна визначити напрямок подальшого руху, порівнявши коефіцієнти біля змінних. Якщо збільшувати значення $s_2$, що має коефіцієнт $-1$, то $\varphi$ лише спадатиме, однак $x_1$ з коефіцієнтом $1$ збільшуватиме оптимальність.

Визначмо межі збільшення $x_1$ з рівнянь системи:

\[
 \left\{\begin{array}{l}
  s_1 = \dfrac{8}{3} - \dfrac{5}{3} x_1 \ldots \\[8pt]
  x_2 = \dfrac{4}{3} - \dfrac{1}{3} x_1 \ldots
 \end{array}\right.
 \overset{s_1, x_2 \geq 0}{\Rightarrow}
 \left\{\begin{array}{l}
  x_1 \leq \dfrac{8}{3} : \dfrac{5}{3} \\[8pt]
  x_1 \leq \dfrac{4}{3} : \dfrac{1}{3}
 \end{array}\right.
 \equiv
 \left\{\begin{array}{l}
  x_1 \leq \dfrac{8}{5} \\[8pt]
  x_1 \leq \dfrac{8}{2}
 \end{array}\right.
\]

Нові значення змінних просторового базису: $x_1 = \dfrac{8}{5}$, $s_2 = 0$. Обрахуймо значення змінних симплекс-базису:

\[
 \left\{\begin{array}{l}
  s_1 = \dfrac{8}{3} - \dfrac{5}{3} \cdot \dfrac{8}{5} + \dfrac{1}{3} \cdot 0 = -\dfrac{16}{9} \\[8pt]
  x_2 = \dfrac{4}{3} - \dfrac{1}{3} \cdot \dfrac{8}{5} - \dfrac{1}{3} \cdot 0 = \dfrac{4}{5}
  \text{.}
 \end{array}\right.
\]

Маємо новий розв'язок: $$\mathbf{X}_2 = \left\langle \dfrac{8}{5}, \dfrac{4}{5}, -\dfrac{16}{9}, 0 \right\rangle^\top,\; \varphi(\mathbf{X}_2) = \dfrac{28}{5} = 5.6 \text{.}$$

Як видно, $\varphi(\mathbf{X}_2) > \varphi(\mathbf{X}_1)$, отже оптимальність розв'язку зросла. Окрім того, оскільки ми збільшували просторову змінну $x_1$ до межі, що визначає змінну $s_1$, то тепер $\mathbf{B}_A \subarrow{x_1} \mathbf{B}_S$ такі $\mathbf{B}_S \subarrow{s_1} \mathbf{B}_A$. Графічно це можна уявити як показано на Рис.~\ref{pic:linear:simplex:example_task1:iter2}.

\illustration
 {../imgs/linear/simplex-task1-graph3.pdf}
 {Утримуючи $s_2 = 0$, і збільшуючи $x_1$ у просторовому базисі $\langle x_1, s_2 \rangle$, ми перетинаємо спочатку лінію $s_1 = 0$ у точці $x_1 = \dfrac{8}{5} = 1.6$, а тоді лінію $x_2 = 0$ у точці $x_1 = \dfrac{8}{2} = 4$. З рисунку видно, що та лінія, яку ми перетинаємо найперше, і формує межу області ОДР. Тому у наступній ітерації зручно включити змінну $s_1$ у просторовий базис; натомість виключаємо $x_1$, бо значення цієї змінної ми вже змінювали раніше.}
 {pic:linear:simplex:example_task1:iter2}

\subsubsection{Ітерація №3}

Щоби отримати запис системи у новому просторовому базисі $\langle s_1, s_2 \rangle$, застосуймо такі перетворення:

\[
\begin{split}
 (s_1 = \dfrac{8}{3} - \dfrac{5}{3} x_1 + \dfrac{1}{3} s_2) \equiv
 \left(x_1 = \dfrac{s_1 - \dfrac{8}{3} - \dfrac{1}{3} s_2}{-\dfrac{5}{3}}\right) \Rightarrow \\[8pt]
 \left\{
  \begin{array}{l@{\;}l@{\;}l@{\;}l@{}l@{}l@{\;}l@{}l}
   x_1 &= \dfrac{1}{5} & -&\dfrac{3}{5} &s_1 &+ &\dfrac{1}{5} & s_2 \\[8pt]
   x_2 &= \dfrac{4}{3} &- &\dfrac{1}{3} &\left( \dfrac{1}{5} - \dfrac{3}{5} s_1 + \dfrac{1}{5} s_2 \right) &-& \dfrac{1}{3} & s_2
  \end{array}
 \right. \equiv
 \left\{
  \begin{array}{l@{\;}c@{\;}l@{\;}c@{}l@{}l@{\;}c@{}l}
   x_1 &= \dfrac{1}{5} & -&\dfrac{3}{5} &s_1 &+ &\dfrac{1}{5} & s_2 \\[8pt]
   x_2 &= \dfrac{19}{15} &+ &\dfrac{3}{15} &s_1 &- &\dfrac{6}{15} &s_2
   \text{.}
  \end{array}
 \right.
\end{split}
\]

Аналогічно з ціновою функцією:

\[
\begin{split}
 \varphi = x_1 - s_2 + 4 = \\
 \left( \dfrac{1}{5} - \dfrac{3}{5}s_1 + \dfrac{1}{5}s_2 \right) - s_2 + 4 = \\
 \dfrac{21}{5} - \dfrac{3}{5} s_1 - \dfrac{4}{5} s_2 + 4 = 0
 \text{.}
\end{split}
\]

Як видно, усі змінні функції $\varphi(s_1, s_2)$ мають від'ємні коефіцієнти. Це означає, що при збільшенні будь-якої з них, значення $\varphi$ лише спадатиме. Отож, позаяк усі сусідні кутові точки мають менше значення оптимальності, ніж поточна, розв'язок $\mathbf{X}_2$ можна вважати оптимальним. І дійсно,

\[
 \equalto{\varphi(\mathbf{X}_0)}{0} <
 \equalto{\varphi(\mathbf{X}_1)}{4} <
 \equalto{\varphi(\mathbf{X}_2)}{5.6}
 \text{.}
\]

\subsubsection{Формування алгоритму}

Ми вже знаємо, що для того, щоби скористатись симплекс-методом, задача ЛП має бути подана у канонічному вигляді: система ОДР складається тільки з рівностей, і $\varphi \rightarrow \max$. Цю процедуру можна формалізувати так, як показано у Алгоритмі~\ref{alg:simplex_canonizing_analytic}.

\begin{algorithm}
\caption{Канонізування задачі ЛП (аналітичне)}
\label{alg:simplex_canonizing_analytic}
\begin{algorithmic}[1]
 \Function{КанонізуванняЛП}{нерівності $a_{i1} x_1 + \ldots + a_{in} x_n \leq b_i$}
  \State {
   провести перетворення
   $$
    \begin{array}{c}
     a_{i1} x_1 + \ldots + a_{in} x_n \leq b_i \\
     \downarrow \\
     a_{i1} x_1 + \ldots + a_{in} x_n  + s_i = b_i
    \end{array}
    $$
   }
  \State {$\mathbf{B}_{A} \gets \langle x_1, \ldots, x_n \rangle^\top$}
  \CommentItl {просторовий базис}
  \State {$\mathbf{B}_{S} \gets \langle s_1, \ldots, s_m \rangle^\top$}
  \CommentItl {симплекс-базис}
\algstore{alg:simplex_canonizing_analytic}
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\begin{algorithmic}
\algrestore{alg:simplex_canonizing_analytic}
  \State {$\forall i: x_i \gets 0, s_i \gets b_i$}
  \CommentItl {початкові значення змінних}
  \State {cформувати систему у вигляді $$G \gets \left\{
   \begin{array}{l@{\;}l@{\;}l@{\;}l@{}l@{\;}l@{}l}
    s_1 = & b_1 & - & a_{11} & x_1 & - \ldots - a_{1n} & x_n \\
    s_2 = & b_2 & - & a_{21} & x_1 & - \ldots - a_{2n} & x_n \\
    \vdots \\
    s_m = & b_m & - & a_{m1} & x_1 & - \ldots - a_{mn} & x_n \\
   \end{array}
  \right.$$}
  \State \Return {$G$, $\mathbf{B}_A$, $\mathbf{B}_S$}
 \EndFunction
\end{algorithmic}
\end{algorithm}

Створений алгоритм -- це лише формалізований процес приведення умови задачі ЛП до канонічного вигляду. Звичайно, що для того, щоби запрограмувати це, потрібно представити систему нерівностей у вигляді структур даних тощо.

Надалі ми можемо записувати систему ОДР у матрично-векторному вигляді як
\[
 \mathbf{B}_S = I \mathbf{b} - \mathbf{A} (- \mathbf{B}_A)
 \text{.}
\]

\begin{note}
 Приводячи задачу ЛП до канонічного вигляду так, як показано у Алгоритмі~\ref{alg:simplex_canonizing_analytic}, ми робимо одне дуже громіздке припущення: \textit{усі нерівності ОДР мають знак \flqq{}$\leq$\frqq{}}. Лише в такому випадку ми можемо сформувати симплекс-базис і брати за опорний план точку $\langle 0, 0, \ldots \rangle$. Ситуація, коли ми цього зробити не можемо, розглянута у наступних розділах.
\end{note}

Дії, що ми виконували далі, можна описати так, як показано у Алгоритмі~\ref{alg:simplex_analytic}.

\begin{algorithm}
\caption{Симплекс-метод (аналітичний)}
\label{alg:simplex_analytic}
\begin{algorithmic}[1]
 \Function{СимплексМетод}{нерівності, $\varphi = \mathbf{X} \mathbf{c}^\top$}
  \State {$G, \mathbf{B}_A, \mathbf{B}_S \gets $ \Call{КанонізуванняЛП}{нерівності}}
  \While{$\forall 1 \leq i \leq n: c_i > 0$}
% \algstore{alg:simplex_analytic}
% \end{algorithmic}
% \end{algorithm}

% \begin{algorithm}
% \begin{algorithmic}
% \algrestore{alg:simplex_analytic}
   \State {вибрати таке $v_a \in \mathbf{B}_A$, що $\varphi$ має доданок $c \cdot v_a$ де $\displaystyle c = \max_{c_i \in \mathbf{c}} c_i$}
   \Statex \CommentItl{вибране $v_a$ буде змінною, що покине просторовий базис}
   \State {вибрати таке $v_s \in \mathbf{B}_S$, що


    \begin{tabular}{lcr}
     $
      G = \left\{\begin{array}{l@{\;}l@{\;}l@{\;}l@{\;}l@{}l}
       s_1 & = & b_1 & - & a_{1l} & v_a - \ldots \\
       s_2 & = & b_2 & - & a_{2l} & v_a - \ldots \\
       \vdots \\
       v_s & = & b_k & - & a_{kl} & v_a - \ldots \\
       \vdots
      \end{array}\right.
     $
     & та &
     $\displaystyle
      \dfrac{b_k}{a_{kl}} = \min_{1 \leq i \leq n} \dfrac{b_i}{a_{il}}
     $
    \end{tabular}
   }
   \Statex \CommentItl{вибране $v_s$ -- це змінна, що покине симплекс-базис; $\forall i: s_i \in \mathbf{B}_S$}
   \State {$v_a \gets \dfrac{b_k}{a_{kl}}$}
   \CommentItl{нове значення змінної просторового базису}
   \State {розрахувати нові значення змінних в $\mathbf{B}_S$}
   \State {$\mathbf{B}_A \subarrow{v_a} \mathbf{B}_S$, $\mathbf{B}_S \subarrow{v_s} \mathbf{B}_A$}
   \CommentItl{запам'ятати нові базиси}
   \State {розв'язати $G$ та $\varphi$ відносно нового симплекс-базису}
   \Statex \CommentItl{тепер ми отримали нові коефіцієнти $c_i$ для $\varphi = \mathbf{c} \mathbf{B}_S^\top$}
   \Statex \CommentItl{також маємо нові $a_{ij}$ та $b_i$ для системи $G$}
  \EndWhile
  \State {$\mathbf{X} \gets \langle x_1, x_2, \ldots x_n \rangle$}
  \Statex \CommentItl{нас цікавлять змінні просторового базису, що був з початку задачі}
  \State \Return {$\mathbf{X}$}
 \EndFunction
\end{algorithmic}
\end{algorithm}

\begin{problem}{problem:linear:pivoting}
 Ми представляли систему ОДР у матрично-векторному вигляді як
 \[
  \mathbf{B}_S = I \mathbf{b} - \mathbf{A}(-\mathbf{B}_A)
  \text{.}
 \]

 Раніше, при заміні базису ми отримували нову систему аналітично, розв'язуючи рівняння відносно потрібної змінної, підставляючи значення в інші рівняння тощо. Чи можна якось знайти нові $\mathbf{A}$ та $\mathbf{b}$ працюючи тільки з матрично-векторним виглядом, не виконуючи жодних алгебраїчних перетворень рівнянь?
\end{problem}

\subsection{Симплекс-таблиці}

Після того, як ми починаємо розуміти геніальні речі, вони зводяться до автоматизації і звичок. Наприклад, замість того, щоби кожен раз уявляти просторові лінійні перетворення, достатньо виконати матричне множення за алгоритмом. Так само, замість того, щоби кожного разу шукати диференціал функції через граничне наближення, ми можемо звести її до табличних функцій, і виконати диференціювання майже бездумно. Такий прийом дуже виручає при виконанні складних задач, але взагалі непридатний для навчання -- саме тому ми спочатку \flqq{}винайшли\frqq{} математичний апарат симплекс-методу, а тепер зводимо його до так званих \flqq{}симплекс-таблиць\frqq{}, хоча, безсумнівно, в інших підручниках читач швидше за все побачить лише приклад з таблицею і зовсім неочевидну інструкцію того, як знайти розв'язок.

\subsubsection{Складання таблиці}

Отож, за допомогою симплекс-таблиці\footnote{(англ.) \textit{simplex tableau}} можна зручно записати систему лінійних рівнянь. Нехай ми маємо двовимірну модель (\ref{eq:linear:simplex:2d_example_model}).

\begin{equation}
  \left\{\begin{array}{l}
    s_1 = b_1 - a_{11} x_1 - a_{12} x_2 \\
    s_2 = b_2 - a_{21} x_1 - a_{22} x_2
  \end{array}\right.
  \equiv
  \left\{\begin{array}{l}
     a_{11} x_1 + a_{12} x_2 + s_1 \phantom{+s_2} = b_1 \\
     a_{21} x_1 + a_{22} x_2 \phantom{+s_1} + s_2 = b_2
  \end{array}\right.
  \label{eq:linear:simplex:2d_example_model}
\end{equation}

Разом із ціновою функцією $\varphi = c_1 x_1 + c_2 x_2$ її можна записати так, як показано далі.

\begin{figure}[!h]
  \centering
  \includegraphics{../imgs/linear/abstract-simplex-tableau.pdf}
\end{figure}

Маючи приведену таблицю, можна використовувати симплекс-метод при ручному розв'язуванні. Введімо також матричний вигляд симплекс-таблиці на першому кроці алгоритму як~(\ref{eq:linear:simplex:example:simplex_tableau_0}). Аналогічно симплекс-таблиця на $n$-ому кроці позначатиметься як~$\mathbf{T}^{(n)}$, а її елементи -- $t_{ij}^{(n)}$. В такому разі, наприклад, $t_{11}^{(1)} = a_{11}$, $t_{m+1;1}^{(1)}=c_1$, а $t_{1;n+n+1}^{(1)}=b_1$.

\begin{equation}
  \mathbf{T}^{(1)} = \begin{bmatrix}
    \mathbf{A}      & I          & \mathbf{b} \\
    \mathbf{c}^\top & \mathbf{0} & 0
  \end{bmatrix} = \begin{bmatrix}
    a_{11} & \hdots & a_{1n} & 1      & \hdots & 0      & b_1    \\
    \vdots & \ddots & \vdots & \vdots & \ddots & \vdots & \vdots \\
    a_{m1} & \hdots & a_{mn} & 0      & \hdots & 1      & b_m    \\
    c_1    & \hdots & c_n    & 0      & \hdots & 0      & 0
  \end{bmatrix}
  \label{eq:linear:simplex:example:simplex_tableau_0}
\end{equation}

Для моделі~(\ref{eq:linear:simplex:2d_example_model}), скажімо, можна скласти матрицю

\[
  \mathbf{T}^{(1)} = \begin{bmatrix}
    a_{11} & a_{12} & 1 & 0 & b_1 \\
    a_{21} & a_{22} & 0 & 1 & b_2 \\
    c_1    & c_2    & 0 & 0 & 0
  \end{bmatrix}
  \text{.}
\]

\begin{note}
  Надалі при розгляді будь-яких інструкцій читачеві краще уявляти їх одночасно і на звичайній симплекс-таблиці, і на матричному представленні.
\end{note}
\begin{figure}
 \centering
 \includegraphics{../imgs/linear/simplex-tableau-1.pdf}
\end{figure}

\begin{figure}
 \centering
 \includegraphics{../imgs/linear/simplex-tableau-expl-1.pdf}
\end{figure}
\section{Цілочисельне лінійне програмування}
\label{section:linear:integer}

\section{Проблеми оптимального вибору}
\label{section:linear:x_in_0-1}

Припустимо таку ситуацію, коли ми маємо набір різних рішень, з яких складається розв'язок проблеми. Наприклад, \textit{складне обчислення можна розпаралелити на $n$ процесорів, кожен з яких має свою продуктивність операцій/с та потужність у ватах. Скільки і які процесори потрібно увімкнути, щоби продуктивності вистачило на виконання деякого обчислення у вказаний час, але спожити щонайменше енергії?} Тоді набір всіх можливих рішень

\[
\begin{split}
P = \{
 \text{увімкнути процесор 1},
 \text{увімкнути процесор 2},
 \ldots, \\
 \text{увімкнути процесор $n$}
\}
\end{split}
.
\]

Відповідно, будь-який розв'язок задачі буде лише підмножиною $P$. Однак такими формулюваннями оперувати дуже не дуже зручно, тому краще ввести характеристичний вектор $\mathbf{X}$, кожен елемент $x_i$ якого позначатиме, чи прийняте деяке $i$-те можливе рішення. Так, якщо $x_i=0$, то $i$-ий процесор варто вимкнути, але якщо $x_i=1$ -- то навпаки.

\begin{note}
 Формально такий випадок можна записати як $\mathbf{X} \in \{0, 1\}^{n}$, або простіше -- $\forall i: x_i \in \{0, 1\}$.
\end{note}

\clearpage
\blindsection{Розв'язування проблем}

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:integer_lp}}

Звичайно, на світі існує безліч ресурсів, які не вийде представити дробами: не можна відправити на роботу двох з половиною робітників, продати половину телевізора абощо. Тоді до умов ОДР додається ще одна -- $\forall i: x_i \in \mathbb{Z}$. Пошук такого розв'язку може бути набагато складнішим, ніж коли $\forall i: x_i \in \mathbb{R}$.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:many_price_fn}}

Кілька цінових функцій може з'явитись тоді, коли розв'язок описується кількома характеристиками. Звичайно, якщо вони якимось чином залежать одна від одної, для спрощення задачі краще обійтись однією (або будь-яким іншим мінімальним числом). Наприклад, між відстанню, яку проходить автомобіль, та кількістю спожитого палива існує пряма залежність, тому при мінімізації чогось одного інша характеристика також зменшуватиметься вже без будь-якого впливу.

Проте якщо існують деякі $\varphi_1 \ldots \varphi_i$, і вони не є пов'язаними, то їх можна, наприклад, просто додати: $\varphi = \sum_i \varphi_i$. В такому разі мінімізація або максимізація $\varphi$ означатиме аналогічну зміну всіх $\varphi_i$.

Припустимо, що якусь $\varphi_n$ потрібно мінімізовувати, а решту $\varphi_i \; \forall {i \neq n}$ -- максимізовувати. Тоді $(-\varphi_n) \rightarrow \max \Rightarrow \varphi_n \rightarrow \min$. В такому разі сумарну оцінку можна сформувати як $\varphi = \varphi_1 + \ldots + \varphi_i - \varphi_n$ -- тоді умова $\varphi \rightarrow \max$ гарантуватиме правильне знаходження розв'язку.

Коли це може бути корисним? Припустимо, продукція різних видів $x_i$ по двох магазинах, де продається за різними цінами $a_i$ та $b_i$ відповідно. В такому разі \flqq{}вигода\frqq{} прийнятого рішення характеризуватиметься оцінками $\varphi_a = a_1 x_1 + a_2 x_2 + \ldots$ та $\varphi_b = b_1 x_1 + b_2 x_2 + \ldots$. Тоді максимізація функції $$\varphi = \varphi_a + \varphi_b = (a_1 + b_1) x_1 + \ldots$$ забезпечуватиме правильне знаходження розв'язку.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:transportation_problem}}

Оскільки за умовою потрібно \flqq{}перевезти якомога більше вантажу\frqq{}, то задля оцінки прийнятого рішення достатньо просто додати всі елементи матриці $\mathbf{X}$:

\[
 \varphi(\mathbf{X}) = \sum_{i=1}^{m} \sum_{j=1}^{n} x_{ij}
\]

До обмежень, приведених у розділі \ref{subsection:linear:transportation_problem}, потрібно додати ще одне, яке запобігатиме перевантаженню доріг. Тоді ОДР матиме такий вигляд:

\[
 \mathbf{X} \in G \Leftarrow \left\{
  \begin{array}{l}
   \vdots \\
   \forall i, j: x_{ij} \leq c_{ij}
  \end{array}
 \right.
\]

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:gradient}}

Теоретично, з допомогою градієнтного спуску можна знайти екстремум будь-якої диференційовної функції, якщо область допустимих розв'язків є неперервна. Позначимо $\mathbf{X}_\alpha = \mathbf{X} + \alpha \, \overrightarrow{\textrm{grad}} \, \varphi \Bigr|_\mathbf{X}$ -- точка, зсунута від даної $\mathbf{X}$ у напрямку вектора градієнту функції $\varphi$ на деякий коефіцієнт $\alpha$. Тоді можна стверджувати, що алгоритм не зможе знайти правильну відповідь, якщо $\exists \widetilde{\mathbf{X}} \in G \, \exists \alpha > 0: \varphi(\mathbf{X}_\alpha) < \varphi(\widetilde{\mathbf{X}}) \;\&\; \mathbf{X}_\alpha \notin G$. Неформально кажучи, подальші кроки у напрямку градієнту виводять нас із ОДР, хоча якщо трохи повернути вектор градієнту, то значення $\varphi$ -- хоч і не так стрімко -- можна збільшити ще. Таку ситуацію можна уявити так, як показано на Рис.~\ref{pic:linear:problem:gradient_out_of_g}.

\illustration[t]
 {../imgs/linear/gradient-out-of-g.pdf}
 {Червона область -- це набір всіх точок $\langle x_1, x_2, \varphi(x_1, x_2)\rangle$ таких, що $\langle x_1, x_2 \rangle \in G$. Якщо слідувати за вектором градієнта, найбільш можлива оптимальність, яку можна досягнути -- $\varphi(\mathbf{X}_\alpha)=1.2$. Насправді на ОДР існує точка $\widetilde{\mathbf{X}}$, яка має ще більшу оптимальність, однак вектор градієнту ніколи на неї не вкаже.}
 {pic:linear:problem:gradient_out_of_g}

Для того, щоби вирішити цю проблему, можна придумати якийсь алгоритм повороту вектора тощо. Втім, подальші дії виходять за межі звичайної вправи, і можуть перетворитись в актуальне дослідження.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:non_convex}}

Опуклим можна вважати такий многокутник, який не містить самоперетинів, а також кожен з його внутрішніх кутів є меншим за $180^\circ$. Спробуймо утворити ОДР за допомогою двох нерівностей так, як показано на Рис.~\ref{pic:linear:problem:convex}.

\illustration
 {../imgs/linear/convex-set.pdf}
 {Область ОДР -- перетин нерівностей ${A: a_{11} x + a_{12} y \leq b_1}$ та ${B: a_{21} x + a_{22} y \leq b_2}$.}
 {pic:linear:problem:convex}

З рисунку видно, що навіть якщо збільшувати кут $\gamma$ між межами двох нерівностей так, що він стане більшим за $180^\circ$, область ОДР все одно залишатиметься опуклою. Змінюючи знаки нерівностей, узагальнюючи такі висновки на решту кутових точок ОДР та багатовимірні простори, наполегливий дослідник зможе дійти до аналітичного доведення такого явища.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:le_problem}}

Для розуміння проблеми найпростіше розглянути її в одновимірному випадку. Нехай ОДР визначена як

\[
 G = \left\{
  \begin{array}{l}
   x \geq a_1 \\
   x \leq a_2
  \end{array}
 \right.,
\]

тоді зрозуміло, що $x$ міститься у закритому відрізку $[a_1, a_2]$, і розв'язком задачі буде одна з його меж. Якщо ж відрізок відкритий, і нам потрібно розв'язати задачу, наприклад, на максимізацію то розв'язком буде деяка границя $x = \displaystyle \lim_{a \to a_1} a$, яку можна обчислити з якою завгодно точністю $\varepsilon$. Припустимо, що $a_1 = 5$, тоді:

\begin{figure}[!h]
 \center
 \begin{tabular}{ll}
  $x = 4.9$,     & $\varepsilon = 10^{-1}$; \\
  $x = 4.999$,   & $\varepsilon = 10^{-3}$; \\
  $x = 4.99999$, & $\varepsilon = 10^{-5}$.
 \end{tabular}
\end{figure}

Розглянемо також двовимірний випадок. Нехай ОДР задана як

\[
 G = \left\{
  \begin{array}{l}
   a_{11} x + a_{12} y < b_1 \\
   a_{21} x + a_{22} y < b_2
  \end{array}
 \right..
\]

Зрозуміло, що на двовимірній площині до точки розв'язку можна наближатись із якої завгодно сторони, тому розумним рішенням буде знайти деяке гранично допустиме значення $x$ та $y$ окремо\footnote{Так само як замість того, щоби говорити про диференціал багатозмінної функції ми аналізуємо натомість частинні похідні.}. Розв'язавши систему відносно $x$ та $y$ отримаємо:

\[
 \begin{array}{ll}
 G = \left\{
  \begin{array}{l}
   x < \dfrac{b_1 - a_{12} y}{a_{11}} \\ [8pt]
   x < \dfrac{b_2 - a_{22} y}{a_{21}}
  \end{array}
 \right.;
 &
 G = \left\{
  \begin{array}{l}
   y < \dfrac{b_1 - a_{11} x}{a_{12}} \\ [8pt]
   y < \dfrac{b_2 - a_{21} x}{a_{22}}
  \end{array}
 \right..
 \end{array}
\]

Тепер до точки перетину двох нерівностей можна наближатись ітеративно:

\begin{enumerate}
 \item припустимо деяке щонайменш можливе початкове значення ${x \to -\infty}$;
 \item з системи нерівностей, розв'язаної відносно $y$ отримаємо найбільше граничне значення $y$ з заданою точністю;
 \item змінюємо $y$, аналогічно знаходимо найбільше можливе значення $x$;
 \item переходимо до другого кроку;
 \item якщо на деякому кроці зміна $x$ і $y$ стала меншою за $\varepsilon$, то це число можна вважати точністю, з якою обчислений розв'язок.
\end{enumerate}

Попрацювавши над цією пробемою, читач може отримати більш універсальний алгоритм, а також узагальнити його для багатовимірних просторів.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:graphical_integer}}

Разом з ОДР на графіку можна також позначити всі точки $\langle x_1, x_2 \rangle \in \mathbb{Z}^2$ -- ті, які лежатимуть всередині ОДР і будуть допустимими розв'язками. Тоді оптимальний розв'язок слід обирати не з однієї з кутових точок, а з тих, що нанесені на графік. Приклад показано на Рис.~\ref{pic:linear:problem:integer_lp}

\illustration
 {../imgs/linear/integer-lp.pdf}
 {Чорними крапками позначено всі допустимі розв'язки з ОДР.}
 {pic:linear:problem:integer_lp}

У випадку, якщо лише одна з координат повинна бути цілочисельною, то на графіку отримаємо набір горизонтальних або вертикальних ліній.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:dim_reduction}}

\textit{Для розв'язування цієї проблеми читач повинен мати хороше інтуїтивне розуміння принципу вимірності простору.} Якщо ми розв'язуємо тривимірну задачу, то замість того, щоби малювати просторовий многогранник, можна намалювати на площині лише одну з його граней -- ту, ну якій за припущенням міститься розв'язок. Таким чином ми перетворюємо тривимірну проблему у двовимірну. Аналогічно можна аналізувати тривимірні перерізи чотиривимірних фігур тощо. Насправді така техніка немає важливого практичного сенсу, але може допомогти при унаочненні даних.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:infite_optimum}}

Якщо весь відрізок визначає оптимальні розв'язки, то це означає, що всі точки на ньому мають однакове значення $\varphi$ -- включно з двома крайніми. Отже, можна стверджувати, що якщо будь-які дві сусідні точки фігури мають однакове значення оптимальності, то всі точки з відрізку між ними є розв'язками задачі -- тобто, їх безліч.

У тривимірному просторі оптимальними розв'язками може бути вся грань фігури ОДР. Для того, щоби визначити такий випадок, потрібно знайти таку послідовність точок $\mathbf{X}_1 \ldots \mathbf{X}_n$, що вони всі є послідовно сусідніми та мають однакову оптимальність. Аналогічно у чотиривимірному просторі потрібно відшукати такий набір площин, що всі їхні кутові точки мають однакову оптимальність, і утворюють межі якогось багатогранника.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:convex_statement}}

Розглянемо матрично-векторний запис системи рівностей з люзовими змінними:

\[
 \mathbf{A} \mathbf{X} + \mathbf{\delta} \mathbf{s} = \mathbf{b}
 \text{.}
\]

Якщо $\mathbf{\delta}$ -- одинична матриця, то рівняння перетворюється в таке:


\[
 \mathbf{A} \mathbf{X} +
 \left[
  \begin{array}{cc}
   1 & 0 \\
   0 & 1
  \end{array}
 \right]
 \left[
  \begin{array}{c}
   s_1 \\
   s_2
  \end{array}
 \right] = \mathbf{b}\text{.}
\]

Це означає, що всі $s_i$ входять у систему рівнянь зі знаком \flqq{}$+$\frqq{} і лише один раз -- а отже кожна з нерівностей, яким задано ОДР має знак \flqq{}$\leq$\frqq{}. Поведінка таких нерівностей продемонстрована на Рис.~\ref{pic:linear:problem:cannonical-statement}.

\illustration
 {../imgs/linear/canonical-statement.pdf}
 {Під яким кутом не була би нахилена межа нерівності зі знаком \flqq{}$\leq$\frqq{}, її область завжди буде знизу. Якщо така нерівність проходить через область координат, де всі $x_i > 0$, то можна стверджувати, що її область спрямована до центру координат.}
 {pic:linear:problem:cannonical-statement}

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:canonical_statement}}

Припустимо, умови ОДР не включають жодної точки $\langle x_1, \ldots x_n \rangle$ такої, що всі її координати додатні. Тоді, якщо створити додаткову умову $\forall i: x_i \geq 0$, то ОДР буде взагалі порожньою, а в іншому випадку включатиме в себе точку центру координат. Отже, можна стверджувати, що $G \neq \varnothing \Rightarrow \mathbf{0} \in G$.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:new_slack}}

Рівняння поданої системи записані у вигляді

\[
 a_{i1} x_1 + a_{i2} x_2 + \ldots + s_i = b_i
 \text{,}
\]

тож якщо ми знаємо всі $a_{ij}$ та $x_i$ за умовою, усі рівняння можна розв'язати відносно $s_i$:

\[
 s_i = b_i - a_{i1} x_1 - a_{i2} x_2 - \ldots
 \text{.}
\]

Взагалі, всю систему можна розв'язати відносно люзових змінних:

\[
 \left\{\begin{array}{l}
  s_1 = b_1 - a_{11} x_1 - a_{12} x_2 - \ldots \\
  s_2 = b_2 - a_{21} x_1 - a_{22} x_2 - \ldots \\
  \vdots
 \end{array}\right.
 \text{.}
\]

Тоді значення усіх $s_i$ випливає з запису системи очевидним чином. Окрім цього, її можна також представити у матрично-векторному вигляді як

\[
 \mathbf{s} = I \mathbf{b} - \mathbf{A}(-\mathbf{X})
 \text{.}
\]

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:new_x1x2}}

Нехай система задана так само, як і в попередньому завдання. Тоді, якщо ми знаємо усі $a_{ij}$, $b_i$ та $s_i$, щоби знайти $\mathbf{X}'$, достатньо лише розв'язати СЛАР відносно $\langle x_1, x_2 \rangle$.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:steepest_point}}

Якщо додати на рисунок задачі умовні ізолінії, що зображали би ріст $\varphi$ так, як показано на Рис.~\ref{pic:linear:steepest_point_with_grad}, стає більш очевидно, що найвигіднішим буде той перехід, лінія якого утворює найменший кут з вектором градієнту.

\illustration
 {../imgs/linear/steepest-point-with-grad.pdf}
 {Ізолінії зображають ріст $\varphi$. Позначення \flqq{}$1$\frqq{}, \flqq{}$2$\frqq{} тощо додані лише для наочності, насправді ж ми не знаємо, яких значень може набувати $\varphi$ у цих точках.}
 {pic:linear:steepest_point_with_grad}

Якщо нам відомі координати $\overrightarrow{\mathrm{grad}} \; \varphi = \langle \varphi_1, \varphi_2 \rangle$, можна оцінити потрібні кути, використовуючи властивості векторного добутку:

\[
 \cos \theta_i =
 \dfrac
  {\langle \varphi_1, \varphi_2 \rangle \cdot \langle x_i, y_i \rangle}
  {|\langle \varphi_1, \varphi_2 \rangle| \cdot |\langle x_i, y_i \rangle|}
  \text{.}
\]

Нам навіть не потрібно знаходити $\theta_i = \arccos \cos \theta_i$, оскільки разом із зростанням $\theta$ значення $\cos \theta$ рівномірно спадає. Тобто, для знаходження мінімального $\theta i$ нам потрібно отримати
\[
 \max_i \{ \cos \theta_i \}
 \text{.}
\]

Обране $i$ позначатиме точку $\langle x_i, y_i \rangle$ перехід до якої дасть найбільше зростання $\varphi$. Звичайно, ці формули працюватимуть так само і для багатовимірних просторів.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:circular_space}}

Користуючись параметричним рівнянням кола можна визначити функцію переходу від $O$ до $R$:

\[
 R(t) =
 \langle
  r \cos (t), r \sin (t)
 \rangle^\top
 \text{.}
\]

Тоді отримані вектори $\forall t \in \mathbb{R} \: \forall O(t) : \langle x,y \rangle^\top$ визначатимуть коло з радіусом $r$ у двовимірному просторі. При чому, лінія $[0, 2 \pi] \in O$ позначатиме повне коло у $R$. Ідея зворотньої функції може з'явитись з формули переходу від полярної системи координат до прямокутної:

\[
 O\left(\langle x,y \rangle^\top\right) = \arctg\left(\dfrac{y}{x}\right)
 \text{.}
\]

Перетворення $R: \mathbb{R} \rightarrow \mathbb{R}^2$ не є лінійними, оскільки не справджується властивість $c L(\mathbf{v}) = L(c\mathbf{v})$:

\[
 \forall c \in \mathbb{R}:
 \begin{bmatrix}
  r \cos (ct) \\ r \sin (ct)
 \end{bmatrix}
 \neq
 c \begin{bmatrix}
  r \cos (t) \\ r \sin (t)
 \end{bmatrix}
 \Rightarrow
 R(ct) \neq cR(t)
 \text{.}
\]

Аналогічно з $O: \mathbb{R}^2 \rightarrow \mathbb{R}$:

\[
 \forall \langle x,y \rangle^\top \in \mathbb{R}^2:
 \arctg\left( c \dfrac{y}{x} \right) \neq c \arctg\left( \dfrac{y}{x} \right)
 \Rightarrow
 O\left(\langle x,y \rangle^\top\right) \neq c O\left(\langle x,y \rangle^\top\right)
\]

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:zero_in_matrix}}

Розгляньмо випадок $\mathbf{A} \in \mathbb{R}^2$. Нехай $a_{11} = 0$, тоді відповідна система рівнянь матиме такий вигляд:

\[
 \left\{\begin{array}{r@{\;}l}
  0      \cdot x_1 & + a_{12} x_2 + s_1 = b_1 \\
  a_{22}       x_1 & + a_{22} x_2 + s_1 = b_1
 \end{array}\right.
 \text{.}
\]

Оскільки перше рівняння не залежить від $x_1$, то утворена ним лінія буде паралельною до осі $x_1$. Наприклад, на Рис.~\ref{pic:linear:slack_figure_zoom_x1s1} лінія $s_3 = 0$ паралельна до осі $x_2$. Це означає, що якщо рухатись із точки $\mathbf{X}_0$ або $\mathbf{X}_1$, збільшуючи $x_2$, ми ніколи не перетнемо лінії $s_3$. Отже якщо під час пошуку меж ми отримали ділення на нуль, таку межу можна просто ігнорувати.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:pivoting}}

Розгляньмо таку систему:

\[
 \left\{\begin{array}{l}
  s_1 = b_1 - a_{11} x_1 - a_{12} x_2 - a_{13} x_3 \\
  s_2 = b_2 - a_{21} x_1 - a_{22} x_2 - a_{23} x_3 \\
  s_3 = b_3 - a_{31} x_1 - a_{32} x_2 - a_{33} x_3
 \end{array}\right.
 \text{.}
\]

Поки що $\mathbf{B}_A = \langle x_1, x_2, x_3 \rangle$, а $\mathbf{B}_S = \langle s_1, s_2, s_3 \rangle$. Припустимо, ми проводимо операцію $\mathbf{B}_A \subarrow{x_2} \mathbf{B}_S$ і $\mathbf{B}_S \subarrow{s_1} \mathbf{B}_A$. Тоді отримуємо таке рівняння:

\[
 x_2 = \dfrac{b_1}{a_{12}} - \dfrac{a_{11}}{a_{12}} x_1 + s_1 - \dfrac{a_{13}}{a_{12}} x_3
 \text{.}
\]

Підставляючи $x_2$ в кожне з рівнянь отримуємо нову систему.

\[
 \left\{\begin{array}{l@{\;}l@{\;}l@{\;}l@{}l@{\;}l@{\;}l@{}l@{\;}l@{\;}l@{}l}
  x_2 & = \dfrac{b_1}{a_{12}} & - & \dfrac{a_{11}}{a_{12}} & x_1 & + &        & s_1 & - & \dfrac{a_{13}}{a_{12}} & x_3 \\[8pt]
  s_2 & = b_2                 & - & a_{21}                 & x_1 & - & a_{22} & \left(\dfrac{b_1}{a_{12}} - \dfrac{a_{11}}{a_{12}} x_1 + s_1 - \dfrac{a_{13}}{a_{12}} x_3\right) & - & a_{23} & x_3 \\[8pt]
  s_3 & = b_3                 & - & a_{31}                 & x_1 & - & a_{32} & \left(\dfrac{b_1}{a_{12}} - \dfrac{a_{11}}{a_{12}} x_1 + s_1 - \dfrac{a_{13}}{a_{12}} x_3\right) & - & a_{33} & x_3 
 \end{array}\right.
 \text{,}
\]

де можемо обрахувати коефіцієнти:

\[
 \left\{\begin{array}{l@{\;}r@{\;}l@{\;}r@{}l@{\;}l@{\;}l@{}l@{\;}l@{\;}r@{}l}
  x_2 = & \dfrac{b_1}{a_{12}} & - & \dfrac{a_{11}}{a_{12}} & x_1 & + &  & s_1 & - & \dfrac{a_{13}}{a_{12}} & x_3 \\[8pt]
  s_2 = & \left(b_2 - \dfrac{a_{22} b_1}{a_{12}}\right) & - & \left(a_{21} + \dfrac{a_{22}a_{11}}{a_{12}}\right) & x_1 & - & & s_1 & - & \left( a_{23} + \dfrac{a_{22} a_{13}}{a_{12}} \right) & x_3 \\[8pt]
  s_3 = & \left(b_3 - \dfrac{a_{32} b_1}{a_{12}}\right) & - & \left(a_{31} + \dfrac{a_{32}a_{11}}{a_{12}}\right) & x_1 & - & & s_1 & - & \left( a_{33} + \dfrac{a_{32} a_{13}}{a_{12}} \right) & x_3 
 \end{array}\right.
 \text{.}
\]

Тепер $\mathbf{B}_A = \langle x_1, s_1, x_3 \rangle$, а $\mathbf{B}_S = \langle x_2, s_2, s_3 \rangle$. Зважаючи, що наша система подана у вигляді $\mathbf{B}_S = I\mathbf{b} - \mathbf{A}(-\mathbf{B}_A)$, знайдімо відповідні $\mathbf{A}$ та $\mathbf{b}$:

\[
 \mathbf{b} = \begin{bmatrix}
  \dfrac{b_1}{a_{12}} \\[8pt]
  b_2 - \dfrac{a_{22} b_1}{a_{12}} \\[8pt]
  b_3 - \dfrac{a_{32} b_1}{a_{12}}
 \end{bmatrix}
 \text{,}\;
 \mathbf{A} = \begin{bmatrix}
  \dfrac{a_{11}}{a_{12}}                & -1 & \dfrac{a_{13}}{a_{12}}                \\[8pt]
  a_{21} + \dfrac{a_{22}a_{11}}{a_{12}} &  1 & a_{23} + \dfrac{a_{22}a_{13}}{a_{12}} \\[8pt]
  a_{31} + \dfrac{a_{32}a_{11}}{a_{12}} &  1 & a_{33} + \dfrac{a_{32}a_{13}}{a_{12}}
 \end{bmatrix}
 \text{.}
\]

Можна помітити такі закономірності:

\begin{itemize}
 \item стовбець у $\mathbf{A}$, що визначає коефіцієнти введеної в просторовий базис змінної $x_2$ заповнений одиницями;
 \item значення рядка у $\mathbf{A}$, що визначав коефіцієнти рівняння виведеної з симплекс-базису змінної, поділені на $a_{12}$ -- коефіцієнт біля $x_2$ у цьому ж рівнянні;
 \item решту значень $\mathbf{A}$ та $\mathbf{b}$ є сумою попередніх значень і деякого дробу зі знаменником $a_{12}$ та чисельником з двох інших коефіцієнтів -- їх теж можна підібрати за певним правилом.
\end{itemize}

Прораховуючи $\mathbf{A}$ та $\mathbf{b}$ для інших базисів, читач помітить, що результат завжди буде мати схожий вигляд, і віднайде правило для підбору коефіцієнтів чисельника.

\end{document}

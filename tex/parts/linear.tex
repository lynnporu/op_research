\makeatletter
\def\input@path{{../}}
\makeatother

\providecommand{\main}{..}
\documentclass[\main/book.tex]{subfiles}

\begin{document}

\chapter{Лінійне програмуванння}

Одночасно простим для розуміння та корисним на практиці є математичний апарат розв'язку задач лінійного програмування (ЛП), з яким читач познайомиться у цьому розділі.

\begin{itemize}
 \item У параграфі \sectionref{section:linear:typical} читач дізнається про деякі типові проблеми ЛП та отримає інтуїтивне розуміння того, як варто формулювати ОДР і цінову функцію.
 \item У параграфі \sectionref{section:linear:geometrical} описано графічний метод розв'язку проблем ЛП для $\mathbf{X} \in \mathbb{R}^2$.
 \item Параграф \sectionref{section:linear:simplex} описує симплекс-метод розв'язування ЛП для $n$-вимірних проблем ($\mathbf{X} \in \mathbb{R}^{\geq 2}$).
 \item У параграфі \sectionref{section:linear:integer} читач дізнається про принцип границь та галужень для розв'язування цілочисельної задачі ЛП.
 \item У параграфі \sectionref{section:linear:x_in_0-1} описано постановку та розв'язування ЛП задачі при $\mathbf{X} \in \{0,1\}^n$.
\end{itemize}

Задачу можна назвати лінійною тоді, коли цінова функція є функцією першого степеня~(\ref{eq:p2:linear-phi}), а область допустимих значень може бути описана лінійними рівностями або нерівностями~(\ref{eq:p2:linear-g-set}).

\begin{equation}
\begin{split}
 \varphi(\mathbf{X}) =
 \sum_{j=1}^n c_j x_j =
 \mathbf{c} \mathbf{X}^\mathrm{T},\;
 \mathbf{c} = \langle c_1, \ldots, c_n \rangle
\end{split}
\label{eq:p2:linear-phi}
\end{equation}

\begin{equation}
 G = \left\{
  \langle x_1, \ldots, x_n \rangle:
  \sum_{j=1}^n a_{ij} x_j\,
   \boxed{\leq, \geq \text{або} =}\,
  b_i
  \,\forall i = \overline{1, m}
 \right\}
 \label{eq:p2:linear-g-set}
\end{equation}

\section{Типові проблеми}
\label{section:linear:typical}

Приведені далі постановки задач є типовими. Вони отримали свою назву від проблеми, у вирішенні якої найкраще використовувати такі означення. Якщо їх проаналізувати, то можна отримати відпрацьований математичний апарат для розв'язання більш специфічних задач.

\subsection{Максимізація прибутку}
\label{section:linear:phi_to_max}

\textit{Фабрика виробляє продукцію $n$ видів. Для неї потрібна певна кількість сировини $m$ видів, при чому її є в обмеженій кількості. Відомо можливий прибуток від реалізації кожного з видів продукції. Якщо існує якийсь оптимальний розподіл всієї сировини на виробництво певних видів продукції так, щоби отримати якнайбільший прибуток, то яким буде такий розподіл?}

Якщо між двома некерованими змінними існує відношення, то доцільно описати його у вигляді матриці. Тому нехай в $\mathbf{A}$ міститимуться елементи $a_{ij}$, кожен з яких означатиме витрату сировини $i$-ого виду на виготовлення продукції $j$-ого виду. Ще одна некерована змінна $\mathbf{b} = \langle b_1, \ldots, b_m \rangle$ позначатиме кількість відповідної сировини кожного виду, доступної на фабриці. Прибуток від реалізації можна визначити вектором $\mathbf{c} = \langle c_1, \ldots, c_n \rangle$.

Керованою змінною є вектор $\mathbf{X} = \langle x_1, \ldots, x_n \rangle$, кожен елемент якого позначає кількість продукції, яку має виготовити фабрика -- ці дані варто змінювати для досягнення оптимальності.

Тоді умовою допустимості розв'язку буде перш за все виконання обмежень на доступну кількість сировини, та деякі очевидні твердження -- наприклад, те, що ця кількість має бути невід'ємною (\ref{eq:p2:problem:phi_to_max:g_set}).

\begin{equation}
 \mathbf{X} \in G \Leftarrow
 \left\{
  \begin{array}{l}
   \displaystyle \sum_{j=1}^n a_{ij} x_j \leq b_i\;
   \forall i = \overline{1, m} \\
   x_j \geq 0 \; \forall j = \overline{1, n}
  \end{array}
 \right\}
 \label{eq:p2:problem:phi_to_max:g_set}
\end{equation}

\begin{question}
Чи можна поставити умову так, щоби знайдені $x_i$ обов'язково повинні були би бути цілими числами?
\end{question}

В означенні (\ref{eq:p2:problem:phi_to_max:g_set}) фор\-му\-лю\-ва\-ння ${\sum_{j=1}^n a_{ij} x_j}$ позначає суму використаної сировини певного типу на виготовлення ресурсів всіх можливих видів. Відповідно \flqq{}$\leq b_i$\frqq{} позначає, що цією сировини можна використати не більше певної кількості. Умова $\forall i$ означає, що така нерівність повинна виконуватись для всіх видів сировини.

Цінову функцію потрібно вводити так, щоби вона визначала прибутковість прийнятого рішення. Тоді оптимальним розв'язком буде такий, що гарантує досягнення її максимуму (\ref{eq:p2:problem:phi_to_max:price}).

\begin{equation}
 \varphi(\mathbf{X}) =
 \sum_{j=1}^n c_j x_j \rightarrow
 \max_{\mathbf{X} \in G}
 \label{eq:p2:problem:phi_to_max:price}
\end{equation}

\begin{question}
 Якщо існує така задача, для якої потрібно вводити кілька цінових функцій, і оптимізовувати їх одночасно, то якою буде умова такої задачі? Чи існує якийсь універсальний спосіб поєднання кількох оцінок оптимальності в одну?
\end{question}

\subsection{Мінімізація витрат}

Розглянемо задачу, подібну тій, що поставлена у розділі \ref{section:linear:phi_to_max}. \textit{Фабрика отримує сировину $n$ видів, з якої виготовляє товар за $m$ різними тех\-но\-ло\-гі\-я\-ми. Кожна з технологій потребує певну комбінацію сировини у різних кількостях. Разом з тим, кожна з технологій спричиняє в атмосферу певну кількість кілограм вуглецю. Для кожного виду сировини визначена доступна кількість, яку можна використати для виробництва. Потрібно оптимізувати виробництво так, щоби отримати якомога більше готової продукції, але водночас зменшити кількість шкідливих викидів.}

Що в цій задачі уже відомого? Найперше -- відношення технології та сировини, яку вона потребує. Запишемо це в матрицю $\mathbf{A}$, в якій кожен елемент $a_{ij}$ позначатиме витрату сировини $i$-ого типу за $j$-ою технологією. Викиди різних технологій можна зберігати у векторі $\mathbf{c} = \langle c_1, \ldots, c_m \rangle$, а кількість доступної сировини кожного виду -- як $\mathbf{b} = \langle b_1, \ldots, b_n \rangle$.

Що потрібно знайти? Потрібно знайти кількість товару, яка буде виготовлена за кожною з технологій. Тому позначимо її через вектор $\mathbf{X} = \langle x_1, \ldots, x_m \rangle$. При пошуку значення різних $x_j$ доведеться вирішити дилему: користуватись технологіями, які потребують меншу кількість сировини, але спричиняють більше викидів, чи навпаки?

Будь-який розв'язок $\mathbf{X}$ буде допустимим, якщо задовольнятиме дві умови: використано ресурсів не більше, ніж доступно взагалі, і жоден з $x_j$ не є від'ємним. Тому ознака допустимості розв'язку є такою самою, як і (\ref{eq:p2:problem:phi_to_max:g_set}) -- ми використовуємо ті самі назви змінних, тому формула не втрачає свого змісту. Тепер формулювання ${\sum_{j=1}^n a_{ij} x_j}$ позначатиме кількість сировини певного виду, використаної загалом, за якими технологіями б не відбувалось виробництво.

Допоки розв'язок допустимий, він використовуватиме лише дос\-туп\-ну кількість сировини. Однак різні розв'язки все ще спричиняють різний викид вуглецю, топу оптимальтність кожного з них визначатимемо саме за цим параметром. Цінова функція знову така сама, як і в (\ref{eq:p2:problem:phi_to_max:price}), проте цього разу її доцільно мінімізувати.

\begin{equation}
 \varphi(\mathbf{X}) =
 \mathbf{c} \mathbf{X}^\mathrm{T}
 \rightarrow \min_{\mathbf{X} \in G}
\end{equation}

\begin{note}
Тепер, після ознайомленнями з двома задачами, важливо розуміти, що не існує жодних правил, як варто складати формулювання ОДР чи цінової функції, так само як і неможливо передбачити всі можливі \flqq{}типові задачі\frqq{}. Формулювання будь-якої математичної моделі залежить винятково від області дослідження та винахідливості дослідника.
\end{note}

\subsection{План перевезень}

Досі ми розглядали задачі, де невідомою керованою змінною був вектор -- тобто, кількість чогось різних видів, або оптимальна конфігурація різних характеристик. Чи можливо тепер за допомогою лінійного програмування розв'язати якусь проблему, що встановлюватиме конфігурацію відношення? Тобто, цього разу невідоме $\mathbf{X}$ буде двовимірним -- матрицею.

\textit{Компанія має у своєму розпорядженні $n$ зерносховищ та $m$ постачальників зерна. Кожне зерносховище може зберігати певну кількість тон зерна, купленого у різних постачальників. З ними укладено контракт, за яким компанія зобов'язується викупити щонайменш певну кількість тон за раз. Відомі затрати на перевезення зерна від кожного постачальника до кожного сховища -- скажімо, час, відстань, пальне тощо. Потрібно визначити, скільки зерна між різними постачальниками та відповідними сховищами доцільно перевезти, щоби отримати якомога менші витрати, та перевезти якомога більше вантажу.}

\illustration
 {linear/transport-graph.pdf}
 {Кожен з постачальників пропонує $\mathbf{a} = {\langle a_1, \ldots, a_m \rangle}$ тон, а кожне зі сховищ може зберігати до $\mathbf{b} = {\langle b_1, \ldots, b_n \rangle}$. Затрати на перевезення між ними задаються матрицею $\mathbf{C} \in \mathbb{R}^{m \times n}$.}
 {pic:linear:transport_problem}

Отже, умову проблеми можна зобразити у вигляді графа, що на Рис.~\ref{pic:linear:transport_problem}. Зрозуміло, що некерованими змінними є $\mathbf{a}$, $\mathbf{b}$ та $\mathbf{C}$. Тоді розв'язком буде матриця $\mathbf{X}$, кожен елемент $x_{ij}$ якої задаватиме \flqq{}оптимальну\frqq{} кількість тон, яку варто перевезти між $i$-им постачальником та $j$-им сховищем. Саме така конфігурація, що буде задана цією матрицею і гарантуватиме найменші витрати та якнайбільше заповнення сховищ.

\begin{note}
 Ця проблема є класичним випадком транспортної задачі, і для її розв'язку існують набагато ефективніші методи, про які можна дізнатись у наступних розділах. Попри це, розв'язок саме лінійним програмуванням є досить цікавим.
\end{note}

Тепер ОДР повинно мати такі обмеження:

\begin{itemize}
 \item потрібно вивезти весь товар, що надають постачальники;
 \item до кожного з сховищ не можна привезти більше, ніж воно може вмістити.
\end{itemize}

Тоді умову допустимості розв'язку можна записати як \ref{eq:linear:problem:matrix_to_matrix:g_set}.

\begin{equation}
 \mathbf{X} \in G \Leftarrow \left\{
 \begin{array}{l}
  \displaystyle
  \sum_{i=1}^m x_{ij} = a_i\; \forall j = \overline{1, n} \\
  \displaystyle
  \sum_{j=1}^n x_{ij} \leq b_j\; \forall i = \overline{1, m}
 \end{array}
 \right\}
 \label{eq:linear:problem:matrix_to_matrix:g_set}
\end{equation}

Тепер для того, щоби порахувати затрати при поточному плані перевезення, достатньо перемножити значення $c_{ij}$ з матриці затрат на значення $x_{ij}$. Оптимальним буде той розв'язок, у якому це значення найменше, тому вводимо цінову функцію (\ref{eq:linear:problem:matrix_to_matrix:price}), і вимагаємо її мінімізації.

\begin{equation}
 \varphi(\mathbf{X}) =
 \sum_{i=1}^m \sum_{j=1}^n
 c_{ij} x_{ij}
 \rightarrow \min_{\mathbf{X} \in G}
 \label{eq:linear:problem:matrix_to_matrix:price}
\end{equation}

\begin{question}
 Нехай матриця $\mathbf{C}$ відображає не затрати на перевезення, а максимальну пропускну здатність маршруту. Скажімо, в день по дорозі між двома пунктами можна перевезти не більше, ніж $c_{ij}$ тон вантажу. Потрібно знайти таке завантаження $\mathbf{X}$ різних доріг, щоби перевезти якомога більше вантажу. Допускається ситуація, коли не весь вантаж буде вивезено від постачальників. Як сформулювати ОДР та цінову функцію?
\end{question}

\section{Геометричний сенс}
\label{section:linear:geometrical}

Двовимірні та (іноді) тривимірні випадки лінійного програмування можна розв'язувати графічно. Розуміння геометричних процесів, які відбуваються при відшукуванні розв'язку допоможуть при розв'язуванні багатовимірних задач.

\subsection{Двовимірний випадок}

Розгляньмо випадок, коли вектор $\mathbf{X}$ складається з двох координат $x_1$ та $x_2$ (тобто, ${\mathbf{X} \in \mathbb{R}^2}$). В ідеальному випадку множина ОДР ${G \in \mathbb{R}^2}$ утворює на площині деяку замкнену область, як показано на Рис.~\ref{pic:linear:example:g_set}. Зрозуміло, що коли обрати будь-яку точку з неї, то такі координати ${\langle x_1, x_2 \rangle}$ є допустимим розв'язком. Допустимих розв'язків існує безкінечна кількість (оскільки ми оперуємо множиною дійсних чисел, яка сама по собі є континуумом), але найоптимальнішим буде той, для якого цінова функція $\varphi(\mathbf{X})$ визначає якнайбільше число. Як можна знайти такий розв'язок графічно?

\illustration
 {linear/2d-plain.pdf}
 {ОДР утворює опуклий багатокутник на площині.}
 {pic:linear:example:g_set}

Проаналізуймо цінову функцію. В загальному випадку вона матиме вигляд $\varphi = c_1 x_1 + c_2 x_2$, тобто утворюватиме площину в тривимірному просторі з координат $\langle x_1, x_2, \varphi \rangle$. Це можна уявити як на Рис.~\ref{pic:linear:example:phi_set}. Тоді допустимі розв'язки лежатимуть всередині проекції ОДР на площину цінової функції. З рисунку добре видно, в яку сторону вона зростає, тож тепер зрозуміло, що точка $\mathbf{X}_1$ є допустимим розв'язком з мінімально можливим $\varphi$, а $\mathbf{X}_5$ -- з максимальним $\varphi$. Тоді обидві точки будуть розв'язками задачі на мінімізацію та максимізацію цінової функції відповідно.

\illustration
 {linear/2d-with-phi.pdf}
 {Погляд на ОДР з іншої перспективи. Пунктиром позначено проекцію $G$ на $\varphi$.}
 {pic:linear:example:phi_set}

Чи існує більш практичний спосіб, без потреби відмальовування тривимірних площин? Оскільки $\varphi$ -- лінійна функція, то за будь-яких $x_1$ та $x_2$ вона є неперервною, і зростає завжди однаково. Тобто, при будь-яких аргументах вектор градієнту завжди буде однакової довжини та спрямований в однаковому напрямку. Це означає, що на звичайному двовимірному малюнку достатньо позначити вектор $\overrightarrow{\mathrm{grad}}\,\varphi$ (як і показано на Рис.~\ref{pic:linear:example:g_set}). Тоді розв'язком задачі на максимізацію буде точка, що лежить якнайдалі у напрямку цього вектору. Аналогічно при мінімізації оптимальна точка розв'язку лежатиме у протилежному напрямку.

\begin{note}
 Продемонстрованим прикладом також можна пояснити випадок, коли цінова функція не є площиною, а має якийсь складніший вигляд, хоч це вже не є лінійним програмуванням. Проекція $G$ на $\varphi$ сформує набір точок $\langle x_1, x_2, \varphi \rangle$, а оптимальним розв'язком буде та, що матиме найбільшу або найменшу координату $\varphi$.
\end{note}

\begin{question}
 Яким чином потрібно модифікувати метод градієнтного спуску, щоби знайти оптимальний розв'язок при якій завгодно функції $\varphi$ та замкненій ОДР? Чи ефективніше використати якийсь інший алгоритм?
\end{question}

\begin{question}
 Чи можна системою нелінійних рівнянь описати таку ОДР, щоби утворився неопуклий многокутник?
\end{question}

\begin{conclusions}
\begin{itemize}
 \item оптимальний розв'язок може бути розташований в одній з кутових точок \footnote{(англ.) extreme point};
 \item кутова точка є оптимальним розв'язком, якщо жодна з сусідніх точок не є оптимальнішою.
\end{itemize}
\label{conclusion:linear:optimal_solution}
\end{conclusions}

\illustration
 {linear/brewery.pdf}
 {Запаси ресурсів, параметри ви\-роб\-ниц\-тва та прибутковість елю й пива.}
 {pic:linear:problem:brewery}

\subsection{Розв'язування задачі}

Розглянемо деяку специфічну задачу. \textit{Броварня виготовляє ель та пиво. Виробництво кожного з них вимагає певної комбінації кукурудзи, хмелю та ячмінного солоду на 1 умовну одиницю (бочку, партію тощо). Кількість ресурсів обмежена. Кожен продукт має свою ціну. Параметри виробництва показано на Рис.~\ref{pic:linear:problem:brewery}. Потрібно розрахувати оптимальну кількість вирбництва двох продуктів, щоби отримати якнайбільший прибуток.}

Некеровані змінні можна позначити вектором $\mathbf{a} = {\langle 220, 5, 540 \rangle}$ (кількість доступних ресурсів на складі), $\mathbf{b} = {\langle 213, 485 \rangle}$ (прибуток від кожного з товарів) та матрицею $\mathbf{A}$ (\ref{eq:linear:problem:brewery:a}), де $a_{ij}$ позначатиме витрату $i$-ого ресурсу на $j$-ий продукт. Вартість кожного з продуктів визначатиме вектор $\mathbf{c} = {\langle 213, 485 \rangle}$.

\begin{equation}
 \mathbf{A} = \begin{bmatrix}
               3 & 0.1 & 15 \\
               7 & 0.1 & 10
              \end{bmatrix}
 \label{eq:linear:problem:brewery:a}
\end{equation}

Тоді керованою змінною є вектор $\mathbf{X} = \langle x_1, x_2 \rangle$ координати якого позначають скільки бочок елю та пива потрібно виготовити відповідно. Якщо розв'язок лежить в ОДР, мусять виконуватись такі умови:

\begin{itemize}
 \item кількість використаних кукурудзи, хмелю та солоду не повинна перевищувати доступної;
 \item не можна виготовити від'ємну кількість продукції.
\end{itemize}

Кількість, використаної кукурудзи обраховується як ${3 x_1 + 7 x_2}$ (тобто, залежить від того, скільки виготовляється обох видів продукту). Оскільки маємо на неї обмеження, можна скласти нерівність ${3 x_1 + 7 x_2 \leq 220}$, що повинна виконуватись для допустимості розв'язку. Аналогічно складаються решту нерівностей, що утворюють ОДР задачі~(\ref{eq:linear:problem:brewery:g_set}).

\begin{equation}
 \mathbf{X} \in G \Leftarrow \left\{\begin{array}{l}
    3 x_1 + 7 x_2 \leq 220 \\
    0.1 x_1 + 0.1 x_2 \leq 5 \\
    15 x_1 + 10 x_2 \leq 540 \\
    x_1, x_2 \geq 0
 \end{array}\right\}
 \label{eq:linear:problem:brewery:g_set}
\end{equation}

Разом з тим оптимальність будь-якої комбінації $x_1$ та $x_2$ доцільно визначати за кількістю прибутку, що вона приносить. Тому цінова функція набуде вигляду~(\ref{eq:linear:problem:brewery:price}).

\begin{equation}
 \varphi(\mathbf{X}) =
 \mathbf{X} \mathbf{c}^\mathrm{T} =
 213 x_1 + 485 x_2
 \rightarrow \max_{\mathbf{X} \in G}
 \label{eq:linear:problem:brewery:price}
\end{equation}

На Рис.~\ref{pic:linear:problem:brewery:g_set} показано ОДР та градієнт цінової функції. З отриманого рисунку видно, що точка з ОДР, найдалі розташована у напрямку градієнта (а значить у напрямку зростання оптимальності), міститься в координатах $x_1 = 21.067$ та $x_2 = 22.4$. Це і є оптимальним розв'язком задачі.

\illustration
 {linear/brewery-feasible.pdf}
 {ОДР задачі на двовимірній площині, що утворюється трьома нерівностями та обмеженнями на додатність $x_1$ і $x_2$.}
 {pic:linear:problem:brewery:g_set}
 
\begin{question}
 Яким був би оптимальний розв'язок задачі, якби знак \flqq{}$\leq$\frqq{} в ОДР замінити на \flqq$<$\frqq?
\end{question}

\begin{question}
 Якби $x_1$ та $x_2$ визначали б не умовні одиниці, а вимірювалися б у бочках (тобто, тепер $\mathbf{X} \in \mathbb{Z}^2$), яким чином розв'язок такої задачі можна знайти графічно?
\end{question}

Як видно, графічний спосіб розв'язку досить зручний і простий. Однак коли результат потрібно отримати з високою точністю, таке роз
\-в'я\-зу\-ван\-ня стає дуже складним та непрактичним, не кажучи вже про те, що реальні задачі рідко коли бувають двовимірними. Проте потрібно віддати належне -- графічний спосіб ідеальний для унаочнювання даних.

\begin{question}
 Чи можна якимось чином зменшити вимірність проблеми ${\mathbf{X} \in \mathbb{R}^{> 2}}$, щоби скористатись графічним способом розв'язування?
\end{question}


\subsection{Крайнощі}

\begin{figure*}
\centering
\begin{minipage}[t]{.47\textwidth}
 \includegraphics{linear/unbounded-g-set.pdf}
 \caption{ОДР складається з однієї нерівності, тому є необмеженою зі сторони від'ємних $x_1$ та $x_2$. Тут можна розв'язати задачу на максимізацію, однак розв'язком мінімізації буде точка $\langle -\infty, -\infty \rangle$.}
 \label{pic:linear:unbounded_g_set}
\end{minipage}\qquad
\begin{minipage}[t]{.47\textwidth}
 \includegraphics{linear/incountable-solutions.pdf}
 \caption{Іноді неможливо визначити точку, що лежить найдалі за напрямком градієнта, оскільки всі точки на деякій лінії мають однакову оптимальність. В такому разі вони всі є оптимальними, і не існує єдиного $\mathbf{X}$.}
 \label{pic:linear:incountable_solutions}
\end{minipage}
\end{figure*}

Описані раніше випадки, взагалі кажучи, є ідеальними, а із задачею нам просто пощастило.

Найперша проблема, яку іноді можна отримати -- ОДР не є замкненою, як показано на Рис.~\ref{pic:linear:unbounded_g_set}. В такому разі з тієї сторони, з якої ОДР необмежена, єдиного розв'язку не існує, позаяк до нього можна наближуватись безкінечно. Якщо така відповідь є допустимою, розв'язком можна вважати точку ${\langle \pm \infty, \pm \infty \rangle}$, однак найчастіше подібний результат просто не є адекватним.

Іноді оптимальних розв'язків існує \textit{безкінечна кількість}. Подібне формулювання може заплутати, і створити враження, ніби оптимальними є взагалі всі можливі розв'язки, хоча це не так. Така ситуація продемонстрована на Рис.~\ref{pic:linear:incountable_solutions}. У відповіді до цієї задачі доречно просто описати закон розрахунку оптимальних $x_1$ та $x_2$.

Може так трапитись, що нерівності, з яких складається ОДР, ніде не перетинаються одночасно, як показано на Рис.~\ref{pic:linear:full_unboundance}. В такому разі ОДР порожня, а отже жодного оптимального розв'язку не може існувати за визначенням.

\illustration
 {linear/full-unboundance.pdf}
 {ОДР складається з 4 нерівностей, однак не існує жодної такої області, де вони всі перетиналися б одночасно. Тому $G = \varnothing$.}
 {pic:linear:full_unboundance}

\subsection{Тривимірний випадок}

Якщо у двовимірному просторі набір лінійних нерівностей може відтинати багатокутник, то у тривимірній області $G$ ми отримаємо багатогранник. Приклад такої фігури показано на Рис.~\ref{pic:linear:3d:g_set}. В цьому випадку читачу може бути складно уявити цінову функцію ${\varphi: \mathbb{R}^3 \rightarrow \mathbb{R}}$, позаяк вона є чотиривимірною, однак сенс залишається той самий: якщо перелік всіх точок фігури посортувати за тим, наскільки \flqq{}далеко\frqq{} вони розташовані в напрямку вектора-градієнта (а він тривимірний), то це одночасно буде перелік, посортований за зростанням оптимальності. Можна ще уявити це як зростання температури, яскравості чи будь-якої іншої зручної характеристики в певному напрямку.

\illustration
 {linear/3d-g-set.pdf}
 {Оскільки така фігура має 7 граней, можна зробити висновок, що вона утворена 7-ома нерівностями. Будь-яка точка $\langle x_1, x_2, x_3 \rangle$ всередині неї є допустимим розв'язком. Зважаючи на напрямок вектора градієнту, точка $\mathbf{X}_2$ є розв'язком задачі на мінімізацію, а $\mathbf{X}_1$ -- на максимізацію цінової функції.}
 {pic:linear:3d:g_set}
 
\begin{note}
 Хоча отримана фігура досить проста на вигляд, малювати площини та визначати їхні перетини від руки насправді дуже складно. У вищих вимірностях проблема стає практично нерозв'язуваною. Тому хороший дослідник потребує більш точних аналітичних методів.
\end{note}


\section{Симплекс-метод}
\label{section:linear:simplex}

З висновків на с. \pageref{conclusion:linear:optimal_solution} може з'явитись така ідея:

\begin{itemize}
 \item якщо оптимальний розв'язок розташований в одній з кутових точок, їх потрібно якимось чином обчислити;
 \item опісля обраховуємо значення цінової функції $\varphi$ у всіх точках;
 \item обираємо точку з найбільшим $\varphi$, тобто найбільшою оптимальністю, і розв'язок знайдено;
 \item якщо якісь дві суміжні точки мають однакову оцінку ефективності, то весь відрізок між ними визначає оптимальні розв'язки (тобто, їх безліч).
\end{itemize}

Читач, який колись пробував конструювати власні алгоритми, може заперечити, що така ідея є рішенням \flqq{}в лоб\frqq{} (бо кутових точок може бути дуже багато), і подібні дії обов'язково призведуть до катастрофічного зростання часової та просторової складності алгоритму. Це справедливе зауваження, тому спробуймо трохи покращити метод:

\begin{itemize}
 \item спочатку обираємо деяку одну заздалегідь відому кутову точку, яку назвемо \textbf{опорним планом}\footnote{(англ.) basic feasible solution} -- наприклад~$\mathbf{X}_0 = {\langle 0, 0, \ldots \rangle}$;
 \item оцінюємо значення $\varphi$ у сусідніх точках, і рухаємось до тієї, яка має найбільшу оптимальність;
 \item якщо обидві сусідні точки мають менше значення оптимальності, поточне рішення і є розв'язком задачі.
\end{itemize}

Що ж, вийшло набагато краще. Власне, описана ідея і лежить в основі симплекс-методу. З'ясуймо ще деякі моменти.

\textbf{Як оцінити оптимальність сусідньої точки?} \quad Припустимо, що цінова функція має вигляд $\varphi = 10 x_1 + 20 x_2$. На першій ітерації ми перебуваємо в координатах $\mathbf{X}_0 = \langle 0, 0 \rangle$, а дві сусідні точки -- ${\mathbf{X}_\mathrm{A} = \langle 0, 5 \rangle}$ і ${\mathbf{X}_\mathrm{B} = \langle 5, 0 \rangle}$. Тепер, якщо ми рухаємось до $\mathbf{X}_\mathrm{A}$, то змінюється лише координата $x_2$, тоді як $x_1$ залишається постійною. Аналогічно при переході до $\mathbf{X}_\mathrm{B}$ змінюється лише $x_1$. Тобто при виборі напрямку потрібно відповісти на таке питання: зміна якої зі змінних призводить до найбільшого зростання~$\varphi$? Очевидно, що якщо одночасно збільшувати обидва аргументи, то доданок $20x_2$ вносить більший вклад у зростання значення $\varphi$, ніж $10x_1$ -- це можна з'ясувати і простими логічними міркуваннями, і за допомогою апарату математичного аналізу, порівнявши $\dfrac{\partial \varphi}{\partial x_1}$ з $\dfrac{\partial \varphi}{\partial x_2}$. Висновок такий: перехід до $\mathbf{X}_\mathrm{B}$ дасть найбільше з можливих зростання значення цінової функції, тому оптимальний розв'язок на цій ітерації стане $\mathbf{X} = \langle 0, 5 \rangle$.
\textbf{Що, як початок координат не є опорним планом?} \quad Якщо всі обмеження ОДР містять знак \flqq{}$\leq$\frqq{} або \flqq{}$<$\frqq{}, і одночасно ${\forall i:} {x_i \geq 0}$, цього ніколи не станеться. В таких випадках вважатимемо постановку задачі \textbf{канонічною}\footnote{Пізніше буде описана ще одна умова канонічності умови задачі.}. Якщо все ж таки існує хоча б одне обмеження зі знаком \flqq{}$\geq$\frqq{}, точка $\langle 0, 0, \ldots \rangle$ може і не бути допустимим розв'язком. В таких випадках вважатимемо постановку \textbf{неканонічною}, і шукатимемо способу її \flqq{}канонізувати\frqq{}.
\textbf{Що, як початок координат не є опорним планом?} \quad Якщо всі обмеження ОДР містять знак \flqq{}$\leq$\frqq{} або \flqq{}$<$\frqq{}, і одночасно ${\forall i:}\, {x_i \geq 0}$, цього ніколи не станеться. В інших випадках, звичайно, точка ${\langle 0, 0, \ldots \rangle}$ може і не бути допустимим розв'язком. Тоді для розв'язування задачі потрібно буде вводити \textbf{штучний базис}. З цією технікою читач ознайомиться у наступних розділах

\begin{note}
 Так стається тому, що під яким би кутом не була б нахилена межа обмеження \flqq{}$<$\frqq{}, область допустимих значень завжди буде спрямована до початку координат. Тому за умови дотатності всіх $x_i$ неможливо створити таку ОДР, щоби вона виключала точку ${\langle 0, 0, \ldots \rangle}$.
 \center
 \includegraphics{linear/canonical-statement.pdf}
\end{note}

\textbf{Як оцінити оптимальність сусідньої точки?} \quad Припустимо, що цінова функція має вигляд $\varphi = 10 x_1 + 20 x_2$. На першій ітерації ми перебуваємо в координатах $\mathbf{X}_0 = \langle 0, 0 \rangle$, а дві сусідні точки -- ${\mathbf{X}_\mathrm{A} = \langle 0, 5 \rangle}$ і ${\mathbf{X}_\mathrm{B} = \langle 5, 0 \rangle}$. Тепер, якщо ми рухатимемось до $\mathbf{X}_\mathrm{A}$, то змінюватиметься лише координата $x_2$, а $x_1=\mathrm{const}$. Аналогічно при переході до $\mathbf{X}_\mathrm{B}$ змінюється лише $x_1$. Тобто при виборі напрямку потрібно відповісти на таке питання: зміна якої зі змінних призводить до найбільшого зростання~$\varphi$? Очевидно, що якщо одночасно збільшувати обидва аргументи, то доданок $20x_2$ вносить більший вклад у зростання значення $\varphi$, ніж $10x_1$ -- це можна з'ясувати і простими логічними міркуваннями, і за допомогою апарату математичного аналізу, порівнявши $\dfrac{\partial \varphi}{\partial x_1}$ з $\dfrac{\partial \varphi}{\partial x_2}$. Висновок такий: перехід до $\mathbf{X}_\mathrm{B}$ дасть найбільше з можливих зростання значення цінової функції, тому оптимальний розв'язок на цій ітерації стане $\mathbf{X} = \langle 0, 5 \rangle$.

\begin{question}
 Нехай на поточній ітерації ми перебуваємо в точці $\langle x_0, y_0 \rangle$. Наступні сусідні точки -- $\langle x_1, y_1 \rangle$ і $\langle x_2, y_2 \rangle$, а цінова функція задана як $\varphi = x c_1 + y c_2$. Чи можна за рисунком оцінити, перехід до якої точки призведе до найшвидшого зростання $\varphi$? Чи можна також зробити це аналітично, не обраховуючи значення $\varphi$? Якщо можна, то як?
 \center
 \includegraphics{linear/steepest-point.pdf}
\end{question}

\begin{conclusions}
 При дослідженні будь-якої операції замість того, щоби винаходити універсальний метод, який працюватиме з будь-якими вхідними даними, можна лише ввести певну \flqq{}стандартну\frqq{} постановку задачі, і описати способи \flqq{}стандартизації\frqq{} тих, що не підпадають під введені критерії. Таким чином можна значно скоротити час на розв'язок задачі.
\end{conclusions}
\begin{figure}
 \centering
 \includegraphics{linear/simplex-tableau-1.pdf}
\end{figure}

\begin{figure}
 \centering
 \includegraphics{linear/simplex-tableau-expl-1.pdf}
\end{figure}
\section{Цілочисельне лінійне програмування}
\label{section:linear:integer}

\section{Проблеми оптимального вибору}
\label{section:linear:x_in_0-1}

Припустимо таку ситуацію, коли ми маємо набір різних рішень, з яких складається розв'язок проблеми. Наприклад, \textit{складне обчислення можна розпаралелити на $n$ процесорів, кожен з яких має свою продуктивність операцій/с та потужність у ватах. Скільки і які процесори потрібно увімкнути, щоби продуктивності вистачило на виконання деякого обчислення у вказаний час, але спожити щонайменше енергії?} Тоді набір всіх можливих рішень

\[
\begin{split}
P = \{
 \text{увімкнути процесор 1},
 \text{увімкнути процесор 2},
 \ldots, \\
 \text{увімкнути процесор $n$}
\}
\end{split}
.
\]

Відповідно, будь-який розв'язок задачі буде лише підмножиною $P$. Однак такими формулюваннями оперувати дуже не дуже зручно, тому краще ввести характеристичний вектор $\mathbf{X}$, кожен елемент $x_i$ якого позначатиме, чи прийняте деяке $i$-те можливе рішення. Так, якщо $x_i=0$, то $i$-ий процесор варто вимкнути, але якщо $x_i=1$ -- то навпаки.

\begin{note}
 Формально такий випадок можна записати як $\mathbf{X} \in \{0, 1\}^{n}$, або простіше -- $\forall i: x_i \in \{0, 1\}$.
\end{note}

\end{document}

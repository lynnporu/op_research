\makeatletter
\def\input@path{{../}}
\makeatother

\providecommand{\main}{..}
\documentclass[\main/book.tex]{subfiles}

\begin{document}

\chapter{Лінійне програмуванння}

Одночасно простим для розуміння та корисним на практиці є математичний апарат розв'язку задач лінійного програмування (ЛП), з яким читач познайомиться у цьому розділі.

\begin{itemize}
 \item У параграфі \sectionref{section:linear:typical} читач дізнається про деякі типові проблеми ЛП та отримає інтуїтивне розуміння того, як варто формулювати ОДР і цінову функцію.
 \item У параграфі \sectionref{section:linear:geometrical} описано графічний метод розв'язку проблем ЛП для $\mathbf{X} \in \mathbb{R}^2$.
 \item Параграф \sectionref{section:linear:simplex} описує симплекс-метод розв'язування ЛП для $n$-вимірних проблем ($\mathbf{X} \in \mathbb{R}^{\geq 2}$).
 \item У параграфі \sectionref{section:linear:integer} читач дізнається про принцип границь та галужень для розв'язування цілочисельної задачі ЛП.
 \item У параграфі \sectionref{section:linear:x_in_0-1} описано постановку та розв'язування ЛП задачі при $\mathbf{X} \in \{0,1\}^n$.
\end{itemize}

Задачу можна назвати лінійною тоді, коли цінова функція є функцією першого степеня~(\ref{eq:p2:linear-phi}), а область допустимих значень може бути описана лінійними рівностями або нерівностями~(\ref{eq:p2:linear-g-set}).

\begin{equation}
\begin{split}
 \varphi(\mathbf{X}) =
 \sum_{j=1}^n c_j x_j =
 \mathbf{c} \mathbf{X}^\top,\;
 \mathbf{c} = \langle c_1, \ldots, c_n \rangle
\end{split}
\label{eq:p2:linear-phi}
\end{equation}

\begin{equation}
 G = \left\{
  \langle x_1, \ldots, x_n \rangle:
  \sum_{j=1}^n a_{ij} x_j\,
   \boxed{\leq, \geq \text{або} =}\,
  b_i
  \,\forall i = \overline{1, m}
 \right\}
 \label{eq:p2:linear-g-set}
\end{equation}

\section{Типові проблеми}
\label{section:linear:typical}

Приведені далі постановки задач є типовими. Вони отримали свою назву від проблеми, у вирішенні якої найкраще використовувати такі означення. Якщо їх проаналізувати, то можна отримати відпрацьований математичний апарат для розв'язання більш специфічних задач.

\subsection{Максимізація прибутку}
\label{section:linear:phi_to_max}

\textit{Фабрика виробляє продукцію $n$ видів. Для неї потрібна певна кількість сировини $m$ видів, при чому її є в обмеженій кількості. Відомо можливий прибуток від реалізації кожного з видів продукції. Якщо існує якийсь оптимальний розподіл всієї сировини на виробництво певних видів продукції так, щоби отримати якнайбільший прибуток, то яким буде такий розподіл?}

Якщо між двома некерованими змінними існує відношення, то доцільно описати його у вигляді матриці. Тому нехай в $\mathbf{A}$ міститимуться елементи $a_{ij}$, кожен з яких означатиме витрату сировини $i$-ого виду на виготовлення продукції $j$-ого виду. Ще одна некерована змінна $\mathbf{b} = \langle b_1, \ldots, b_m \rangle$ позначатиме кількість відповідної сировини кожного виду, доступної на фабриці. Прибуток від реалізації можна визначити вектором $\mathbf{c} = \langle c_1, \ldots, c_n \rangle$.

Керованою змінною є вектор $\mathbf{X} = \langle x_1, \ldots, x_n \rangle$, кожен елемент якого позначає кількість продукції, яку має виготовити фабрика -- ці дані варто змінювати для досягнення оптимальності.

Тоді умовою допустимості розв'язку буде перш за все виконання обмежень на доступну кількість сировини, та деякі очевидні твердження -- наприклад, те, що ця кількість має бути невід'ємною (\ref{eq:p2:problem:phi_to_max:g_set}).

\begin{equation}
 \mathbf{X} \in G \Leftarrow
 \left\{
  \begin{array}{l}
   \displaystyle \sum_{j=1}^n a_{ij} x_j \leq b_i\;
   \forall i = \overline{1, m} \\
   x_j \geq 0 \; \forall j = \overline{1, n}
  \end{array}
 \right\}
 \label{eq:p2:problem:phi_to_max:g_set}
\end{equation}

\begin{problem}{problem:linear:integer_lp}
Чи можна поставити умову так, щоби знайдені $x_i$ обов'язково повинні були би бути цілими числами?
\end{problem}

В означенні (\ref{eq:p2:problem:phi_to_max:g_set}) фор\-му\-лю\-ва\-ння ${\sum_{j=1}^n a_{ij} x_j}$ позначає суму використаної сировини певного типу на виготовлення ресурсів всіх можливих видів. Відповідно \flqq{}$\leq b_i$\frqq{} позначає, що цією сировини можна використати не більше певної кількості. Умова $\forall i$ означає, що така нерівність повинна виконуватись для всіх видів сировини.

Цінову функцію потрібно вводити так, щоби вона визначала прибутковість прийнятого рішення. Тоді оптимальним розв'язком буде такий, що гарантує досягнення її максимуму (\ref{eq:p2:problem:phi_to_max:price}).

\begin{equation}
 \varphi(\mathbf{X}) =
 \sum_{j=1}^n c_j x_j \rightarrow
 \max_{\mathbf{X} \in G}
 \label{eq:p2:problem:phi_to_max:price}
\end{equation}

\begin{problem}{problem:linear:many_price_fn}
 Якщо існує така задача, для якої потрібно вводити кілька цінових функцій, і оптимізовувати їх одночасно, то якою буде умова такої задачі? Чи існує якийсь універсальний спосіб поєднання кількох оцінок оптимальності в одну?
\end{problem}

\subsection{Мінімізація витрат}

Розглянемо задачу, подібну тій, що поставлена у розділі~\ref{section:linear:phi_to_max}. \textit{Фабрика отримує сировину $n$ видів, з якої виготовляє товар за $m$ різними тех\-но\-ло\-гі\-я\-ми. Кожна з технологій потребує певну комбінацію сировини у різних кількостях. Разом з тим, кожна з технологій спричиняє в атмосферу викид певної кількості кілограм вуглецю. Для кожного виду сировини визначена доступна кількість, яку можна використати для виробництва. Потрібно оптимізувати виробництво так, щоби отримати якомога більше готової продукції, але водночас зменшити кількість шкідливих викидів.}

Що в цій задачі уже відомого? Найперше -- відношення технології та сировини, яку вона потребує. Запишемо це в матрицю $\mathbf{A}$, в якій кожен елемент $a_{ij}$ позначатиме витрату сировини $i$-ого типу за $j$-ою технологією. Викиди різних технологій можна зберігати у векторі $\mathbf{c} = \langle c_1, \ldots, c_m \rangle$, а кількість доступної сировини кожного виду -- як $\mathbf{b} = \langle b_1, \ldots, b_n \rangle$.

Що потрібно знайти? Потрібно знайти кількість товару, яка буде виготовлена за кожною з технологій. Тому позначимо її через вектор $\mathbf{X} = \langle x_1, \ldots, x_m \rangle$. При пошуку значення різних $x_j$ доведеться вирішити дилему: користуватись технологіями, які потребують меншу кількість сировини, але спричиняють більше викидів, чи навпаки?

Будь-який розв'язок $\mathbf{X}$ буде допустимим, якщо задовольнятиме дві умови: використано ресурсів не більше, ніж доступно взагалі, і жоден з $x_j$ не є від'ємним. Тому ознака допустимості розв'язку є такою самою, як і (\ref{eq:p2:problem:phi_to_max:g_set}) -- ми використовуємо ті самі назви змінних, тому формула не втрачає свого змісту. Тепер формулювання ${\sum_{j=1}^n a_{ij} x_j}$ позначатиме кількість сировини певного виду, використаної загалом, за якими технологіями б не відбувалось виробництво.

Допоки розв'язок допустимий, він використовуватиме лише дос\-туп\-ну кількість сировини. Однак різні розв'язки все ще спричиняють різний викид вуглецю, тому оптимальтність кожного з них визначатимемо саме за цим параметром. Цінова функція знову така сама, як і в (\ref{eq:p2:problem:phi_to_max:price}), проте цього разу її доцільно мінімізувати.

\begin{equation}
 \varphi(\mathbf{X}) =
 \mathbf{c} \mathbf{X}^\top
 \rightarrow \min_{\mathbf{X} \in G}
\end{equation}

\begin{note}
Тепер, після ознайомленнями з двома задачами, важливо розуміти, що не існує жодних правил, як варто складати формулювання ОДР чи цінової функції, так само як і неможливо передбачити всі можливі \flqq{}типові задачі\frqq{}. Формулювання будь-якої математичної моделі залежить винятково від області дослідження та винахідливості дослідника.
\end{note}

\subsection{План перевезень}

Досі ми розглядали задачі, де невідомою керованою змінною був вектор -- тобто, кількість чогось різних видів, або оптимальна конфігурація різних характеристик. Чи можливо тепер за допомогою лінійного програмування розв'язати якусь проблему, що встановлюватиме конфігурацію відношення? Тобто, цього разу невідоме $\mathbf{X}$ буде двовимірним -- матрицею.

\textit{Компанія має у своєму розпорядженні $n$ зерносховищ та $m$ постачальників зерна. Кожне зерносховище може зберігати певну кількість тон зерна, купленого у різних постачальників. З ними укладено контракт, за яким компанія зобов'язується викупити щонайменш певну кількість тон за раз. Відомі затрати на перевезення зерна від кожного постачальника до кожного сховища -- скажімо, час, відстань, пальне тощо. Потрібно визначити, скільки зерна між різними постачальниками та відповідними сховищами доцільно перевезти, щоби отримати якомога менші витрати, та перевезти якомога більше вантажу.}

\illustration
 {../imgs/linear/transport-graph.pdf}
 {Кожен з постачальників пропонує $\mathbf{a} = {\langle a_1, \ldots, a_m \rangle}$ тон, а кожне зі сховищ може зберігати до $\mathbf{b} = {\langle b_1, \ldots, b_n \rangle}$. Затрати на перевезення між ними задаються матрицею $\mathbf{C} \in \mathbb{R}^{m \times n}$.}
 {pic:linear:transport_problem}

Отже, умову проблеми можна зобразити у вигляді графа, що на Рис.~\ref{pic:linear:transport_problem}. Зрозуміло, що некерованими змінними є $\mathbf{a}$, $\mathbf{b}$ та $\mathbf{C}$. Тоді розв'язком буде матриця $\mathbf{X}$, кожен елемент $x_{ij}$ якої задаватиме \flqq{}оптимальну\frqq{} кількість тон, яку варто перевезти між $i$-им постачальником та $j$-им сховищем. Саме така конфігурація, що буде задана цією матрицею і гарантуватиме найменші витрати та якнайбільше заповнення сховищ.

\begin{note}
 Ця проблема є класичним випадком транспортної задачі, і для її розв'язку існують набагато ефективніші методи, про які можна дізнатись у наступних розділах. Попри це, розв'язок саме лінійним програмуванням є досить цікавим.
\end{note}

Тепер ОДР повинно мати такі обмеження:

\begin{itemize}
 \item потрібно вивезти весь товар, що надають постачальники;
 \item до кожного зі сховищ не можна привезти більше, ніж воно може вмістити.
\end{itemize}

Тоді умову допустимості розв'язку можна записати як~\ref{eq:linear:problem:matrix_to_matrix:g_set}.

\begin{equation}
 \mathbf{X} \in G \Leftarrow \left\{
 \begin{array}{l}
  \displaystyle
  \sum_{i=1}^m x_{ij} = a_i\; \forall j = \overline{1, n} \\
  \displaystyle
  \sum_{j=1}^n x_{ij} \leq b_j\; \forall i = \overline{1, m}
 \end{array}
 \right\}
 \label{eq:linear:problem:matrix_to_matrix:g_set}
\end{equation}

Тепер для того, щоби порахувати затрати при поточному плані перевезення, достатньо перемножити значення $c_{ij}$ з матриці затрат на значення $x_{ij}$. Оптимальним буде той розв'язок, у якому це значення найменше, тому вводимо цінову функцію (\ref{eq:linear:problem:matrix_to_matrix:price}), і вимагаємо її мінімізації.

\begin{equation}
 \varphi(\mathbf{X}) =
 \sum_{i=1}^m \sum_{j=1}^n
 c_{ij} x_{ij}
 \rightarrow \min_{\mathbf{X} \in G}
 \label{eq:linear:problem:matrix_to_matrix:price}
\end{equation}

\begin{problem}{problem:linear:transpotation_problem}
 Нехай матриця $\mathbf{C}$ відображає не затрати на перевезення, а максимальну пропускну здатність маршруту. Скажімо, в день по дорозі між двома пунктами можна перевезти не більше, ніж $c_{ij}$ тон вантажу. Потрібно знайти таке завантаження $\mathbf{X}$ різних доріг, щоби перевезти якомога більше вантажу. Допускається ситуація, коли не весь вантаж буде вивезено від постачальників. Як сформулювати ОДР та цінову функцію?
\end{problem}

\section{Геометричний сенс}
\label{section:linear:geometrical}

Двовимірні та (іноді) тривимірні випадки лінійного програмування можна розв'язувати графічно. Розуміння геометричних процесів, які відбуваються при відшукуванні розв'язку допоможуть при розв'язуванні багатовимірних задач.

\subsection{Двовимірний випадок}

Розгляньмо випадок, коли вектор $\mathbf{X}$ складається з двох координат $x_1$ та $x_2$ (тобто, ${\mathbf{X} \in \mathbb{R}^2}$). В ідеальному випадку множина ОДР ${G \in \mathbb{R}^2}$ утворює на площині деяку замкнену область, як показано на Рис.~\ref{pic:linear:example:g_set}. Зрозуміло, що коли обрати будь-яку точку з неї, то такі координати ${\langle x_1, x_2 \rangle}$ є допустимим розв'язком. Допустимих розв'язків існує безкінечна кількість (оскільки ми оперуємо множиною дійсних чисел, яка сама по собі є континуумом), але найоптимальнішим буде той, для якого цінова функція $\varphi(\mathbf{X})$ визначає якнайбільше число. Як можна знайти такий розв'язок графічно?

\illustration
 {../imgs/linear/2d-plain.pdf}
 {ОДР утворює опуклий багатокутник на площині.}
 {pic:linear:example:g_set}

Проаналізуймо цінову функцію. В загальному випадку вона матиме вигляд $\varphi = c_1 x_1 + c_2 x_2$, тобто утворюватиме площину в тривимірному просторі з координат $\langle x_1, x_2, \varphi \rangle$. Це можна уявити як на Рис.~\ref{pic:linear:example:phi_set}. Тоді допустимі розв'язки лежатимуть всередині проекції ОДР на площину цінової функції. З рисунку добре видно, в яку сторону вона зростає, тож тепер зрозуміло, що точка $\mathbf{X}_1$ є допустимим розв'язком з мінімально можливим $\varphi$, а $\mathbf{X}_5$ -- з максимальним $\varphi$. Тоді обидві точки будуть розв'язками задачі на мінімізацію та максимізацію цінової функції відповідно.

\illustration
 {../imgs/linear/2d-with-phi.pdf}
 {Погляд на ОДР з іншої перспективи. Пунктиром позначено проекцію $G$ на $\varphi$.}
 {pic:linear:example:phi_set}

Чи існує більш практичний спосіб, без потреби відмальовування тривимірних площин? Оскільки $\varphi$ -- лінійна функція, то за будь-яких $x_1$ та $x_2$ вона є неперервною, і зростає завжди однаково. Тобто, при будь-яких аргументах вектор градієнту завжди буде однакової довжини та спрямований в однаковому напрямку. Це означає, що на звичайному двовимірному малюнку достатньо позначити вектор $\overrightarrow{\mathrm{grad}}\,\varphi$ (як і показано на Рис.~\ref{pic:linear:example:g_set}). Тоді розв'язком задачі на максимізацію буде точка, що лежить якнайдалі у напрямку цього вектору. Аналогічно при мінімізації оптимальна точка розв'язку лежатиме у протилежному напрямку.

\begin{note}
 Продемонстрованим прикладом також можна пояснити випадок, коли цінова функція не є площиною, а має якийсь складніший вигляд, хоч це вже не буде задачею ЛП. Проекція $G$ на $\varphi$ сформує набір точок $\langle x_1, x_2, \varphi \rangle$, а оптимальним розв'язком буде та, що матиме найбільшу або найменшу координату $\varphi$.
\end{note}

\begin{problem}{problem:linear:gradient}
 Яким чином потрібно модифікувати метод градієнтного спуску, щоби знайти оптимальний розв'язок при якій завгодно функції $\varphi$ та замкненій ОДР? Чи ефективніше використати якийсь інший алгоритм?
\end{problem}

\begin{problem}{problem:linear:non_convex}
 Чи можна системою нелінійних рівнянь описати таку ОДР, щоби утворився неопуклий багатокутник?
\end{problem}

\begin{conclusions}
\begin{itemize}
 \item оптимальний розв'язок може бути розташований в одній з кутових точок \footnote{(англ.) \textit{extreme point}};
 \item кутова точка є оптимальним розв'язком, якщо жодна з сусідніх точок не є оптимальнішою.
\end{itemize}
\label{conclusion:linear:optimal_solution}
\end{conclusions}

\illustration
 {../imgs/linear/brewery.pdf}
 {Запаси ресурсів, параметри ви\-роб\-ниц\-тва та прибутковість елю й пива.}
 {pic:linear:problem:brewery}

\subsection{Розв'язування задачі}

Розглянемо деяку специфічну задачу. \textit{Броварня виготовляє ель та пиво. Виробництво кожного з них вимагає певної комбінації кукурудзи, хмелю та ячмінного солоду на 1 умовну одиницю (бочку, партію тощо). Кількість ресурсів обмежена. Кожен продукт має свою ціну. Параметри виробництва показано на Рис.~\ref{pic:linear:problem:brewery}. Потрібно розрахувати оптимальну кількість вирбництва двох продуктів, щоби отримати якнайбільший прибуток.}

Некеровані змінні можна позначити вектором $\mathbf{a} = {\langle 220, 5, 540 \rangle}$ (кількість доступних ресурсів на складі), $\mathbf{b} = {\langle 213, 485 \rangle}$ (прибуток від кожного з товарів) та матрицею $\mathbf{A}$ (\ref{eq:linear:problem:brewery:a}), де $a_{ij}$ позначатиме витрату $i$-ого ресурсу на $j$-ий продукт. Вартість кожного з продуктів визначатиме вектор $\mathbf{c} = {\langle 213, 485 \rangle}$.

\begin{equation}
 \mathbf{A} = \begin{bmatrix}
               3 & 0.1 & 15 \\
               7 & 0.1 & 10
              \end{bmatrix}
 \label{eq:linear:problem:brewery:a}
\end{equation}

Тоді керованою змінною є вектор $\mathbf{X} = \langle x_1, x_2 \rangle$ координати якого позначають скільки бочок елю та пива потрібно виготовити відповідно. Якщо розв'язок лежить в ОДР, мусять виконуватись такі умови:

\begin{itemize}
 \item кількість використаних кукурудзи, хмелю та солоду не повинна перевищувати доступної;
 \item не можна виготовити від'ємну кількість продукції.
\end{itemize}

Кількість, використаної кукурудзи обраховується як ${3 x_1 + 7 x_2}$ (тобто, залежить від того, скільки виготовляється обох видів продукту). Оскільки маємо на неї обмеження, можна скласти нерівність ${3 x_1 + 7 x_2 \leq 220}$, що повинна виконуватись для допустимості розв'язку. Аналогічно складаються решту нерівностей, що утворюють ОДР задачі~(\ref{eq:linear:problem:brewery:g_set}).

\begin{equation}
 \mathbf{X} \in G \Leftarrow \left\{\begin{array}{l}
    3 x_1 + 7 x_2 \leq 220 \\
    0.1 x_1 + 0.1 x_2 \leq 5 \\
    15 x_1 + 10 x_2 \leq 540 \\
    x_1, x_2 \geq 0
 \end{array}\right\}
 \label{eq:linear:problem:brewery:g_set}
\end{equation}

Разом з тим оптимальність будь-якої комбінації $x_1$ та $x_2$ доцільно визначати за кількістю прибутку, що вона приносить. Тому цінова функція набуде вигляду~(\ref{eq:linear:problem:brewery:price}).

\begin{equation}
 \varphi(\mathbf{X}) =
 \mathbf{X} \mathbf{c}^\top =
 213 x_1 + 485 x_2
 \rightarrow \max_{\mathbf{X} \in G}
 \label{eq:linear:problem:brewery:price}
\end{equation}

На Рис.~\ref{pic:linear:problem:brewery:g_set} показано ОДР та градієнт цінової функції. З отриманого рисунку видно, що точка з ОДР, найдалі розташована у напрямку градієнта (а значить у напрямку зростання оптимальності), міститься в координатах $x_1 = 21.067$ та $x_2 = 22.4$. Це і є оптимальним розв'язком задачі.

\illustration
 {../imgs/linear/brewery-feasible.pdf}
 {ОДР задачі на двовимірній площині, що утворюється трьома нерівностями та обмеженнями на додатність $x_1$ і $x_2$.}
 {pic:linear:problem:brewery:g_set}
 
\begin{problem}{problem:linear:le_problem}
 Яким був би оптимальний розв'язок задачі, якби знак \flqq{}$\leq$\frqq{} в ОДР замінити на \flqq$<$\frqq?
\end{problem}

\begin{problem}{problem:linear:graphical_integer}
 Якби $x_1$ та $x_2$ визначали б не умовні одиниці, а вимірювалися б у бочках (тобто, тепер $\mathbf{X} \in \mathbb{Z}^2$), яким чином розв'язок такої задачі можна знайти графічно?
\end{problem}

Як видно, графічний спосіб розв'язку досить зручний і простий. Однак коли результат потрібно отримати з високою точністю, таке роз\-в'я\-зу\-ван\-ня стає дуже складним та непрактичним, не кажучи вже про те, що реальні задачі рідко коли бувають двовимірними. Проте потрібно віддати належне -- графічний спосіб ідеальний для унаочнювання даних.

\begin{problem}{problem:linear:dim_reduction}
 Чи можна якимось чином зменшити вимірність проблеми ${\mathbf{X} \in \mathbb{R}^{> 2}}$, щоби скористатись графічним способом розв'язування?
\end{problem}


\subsection{Крайнощі}

\twocolminipage
 {
  \nofigillustration
   {../imgs/linear/unbounded-g-set.pdf}
   {ОДР складається з однієї нерівності, тому є необмеженою зі сторони від'ємних $x_1$ та $x_2$. Тут можна розв'язати задачу на максимізацію, однак розв'язком мінімізації буде точка ${\langle -\infty, -\infty \rangle}$.}
   {pic:linear:unbounded_g_set}
 }{
  \nofigillustration
   {../imgs/linear/incountable-solutions.pdf}
   {Іноді неможливо визначити точку, що лежить найдалі за напрямком градієнта, оскільки всі точки на деякій лінії мають однакову оптимальність. В такому разі вони всі є оптимальними, і не існує єдиного $\mathbf{X}$.}
   {pic:linear:incountable_solutions}
 }

Описані раніше випадки, взагалі кажучи, є ідеальними, а із задачею нам просто пощастило.

Найперша проблема, яку іноді можна отримати -- ОДР не є замкненою, як показано на Рис.~\ref{pic:linear:unbounded_g_set}. В такому разі з тієї сторони, з якої ОДР необмежена, єдиного розв'язку не існує, позаяк до нього можна наближуватись безкінечно. Якщо така відповідь є допустимою, розв'язком можна вважати точку ${\langle \pm \infty, \pm \infty \rangle}$, однак найчастіше подібний результат просто не є адекватним.

Іноді оптимальних розв'язків існує \textit{безкінечна кількість}. Подібне формулювання може заплутати, і створити враження, ніби оптимальними є взагалі всі можливі розв'язки, хоча це не так. Така ситуація продемонстрована на Рис.~\ref{pic:linear:incountable_solutions}. У відповіді до цієї задачі доречно просто описати закон розрахунку оптимальних $x_1$ та $x_2$.

Може так трапитись, що нерівності, з яких складається ОДР, ніде не перетинаються одночасно, як показано на Рис.~\ref{pic:linear:full_unboundance}. В такому разі ОДР порожня, а отже жодного оптимального розв'язку не може існувати за визначенням.

\illustration
 {../imgs/linear/full-unboundance.pdf}
 {ОДР складається з 4 нерівностей, однак не існує жодної такої області, де вони всі перетиналися б одночасно. Тому $G = \varnothing$.}
 {pic:linear:full_unboundance}

\subsection{Тривимірний випадок}

Якщо у двовимірному просторі набір лінійних нерівностей може відтинати багатокутник, то у тривимірній області $G$ ми отримаємо багатогранник. Приклад такої фігури показано на Рис.~\ref{pic:linear:3d:g_set}. В цьому випадку читачу може бути складно уявити цінову функцію ${\varphi: \mathbb{R}^3 \rightarrow \mathbb{R}}$, позаяк вона є чотиривимірною, однак сенс залишається той самий: якщо перелік всіх точок фігури посортувати за тим, наскільки \flqq{}далеко\frqq{} вони розташовані в напрямку вектора-градієнта (а він тривимірний), то це одночасно буде перелік, посортований за зростанням оптимальності. Можна ще уявити це як зростання температури, яскравості чи будь-якої іншої простої для розуміння характеристики в певному напрямку.

\illustration
 {../imgs/linear/3d-g-set.pdf}
 {Оскільки така фігура має 7 граней, можна зробити висновок, що вона утворена 7-ома нерівностями. Будь-яка точка $\langle x_1, x_2, x_3 \rangle$ всередині неї є допустимим розв'язком. Зважаючи на напрямок вектора градієнту, точка $\mathbf{X}_2$ є розв'язком задачі на мінімізацію, а $\mathbf{X}_1$ -- на максимізацію цінової функції.}
 {pic:linear:3d:g_set}
 
\begin{note}
 Хоча отримана фігура досить проста на вигляд, малювати площини та визначати їхні перетини від руки насправді дуже складно. У вищих вимірностях проблема стає практично нерозв'язуваною. Тому хороший дослідник потребує більш точних аналітичних методів.
\end{note}

\section{Важливі концепти}

Далі читач дізнається про симплекс-метод -- інструмент, за допомогою якого можна аналітично розв'язувати багатовимірні задачі ЛП. Однак дуже часто при поясненні цього алгоритму опускають багато важливих концептів, тож дослідник отримує незрозумілу йому інструкцію того, в якому порядку потрібно виконувати певні арифметичні операції, і як зрозуміти, що розв'язок знайдено. Щоби уникнути такої сумної ситуації, читачу потрібно спочатку зрозуміти деякі важливі концепти. Спершу вони видаватимуться абсолютно непов'язаними один з одним, проте в результаті все пов'яжеться у єдиний пазл.

\subsection{Люзові змінні}

Будь яку лінійну нерівність $f(x_1, \ldots) \leq b$ можна перетворити у рівність $f(x_1, \ldots) + s = b$. Тоді при ${s=0}$ ми отримаємо лінію, яка лежить на межі області нерівності. При збільшенні $s$ вона буде паралельно переноситись все далі від цієї межі, аж доки при $s=b$ не пройде через центр координат. Отже, при всіх $s \geq 0$ отримане рівняння описуватиме всі можливі точки $\langle x_1, x_2, \ldots \rangle$ всередині області нерівності. Це показано на Рис.~\ref{pic:linear:slack_inequality_leq} та Рис.~\ref{pic:linear:slack_inequality_geq}. Такі змінні $s$ називається \textbf{люзовими}\footnote{(англ.) \textit{slack variables} для нерівностей зі знаком~\flqq{}$\leq$\frqq{}, \textit{surplus variables} для нерівностей~\flqq{}$\geq$\frqq{}.}.

\begin{problem}{problem:linear:inequality_iterating}
 Яким ще зручним способом можна аналітично отримати всі точки всередині області нерівності?
\end{problem}

\begin{figure*}
 \centering
 \begin{minipage}[t]{.47\textwidth}
  \includegraphics{../imgs/linear/slack-inequality-leq.pdf}
  \caption{Нерівність $x_1 + x_2 \leq 4$ утворює область, межу якої можна описати рівнянням $x_1 + x_2 + s = 4$ при $s=0$. При $s=b=4$ ця лі\-нія проходить через центр координат.}
  \label{pic:linear:slack_inequality_leq}
 \end{minipage}\qquad
 \begin{minipage}[t]{.47\textwidth}
  \includegraphics{../imgs/linear/slack-inequality-geq.pdf}
  \caption{Для того, щоби отримати такий самий ефект для нерівностей \flqq{}$\geq$\frqq{}, змінну $s$ потрібно включити у рівняння прямої зі знаком~\flqq{}$-$\frqq{}.}
  \label{pic:linear:slack_inequality_geq}
 \end{minipage}
\end{figure*}

Погляньмо детальніше на нерівність $f(x_1, x_2, \ldots) \leq b$, якою задаються умови на ОДР задачі лінійного програмування. Її можна переписати так:
 
\[
 \begin{array}{lrlll}
  f(x_1, x_2, \ldots) &  \leq b &                         & \equiv &            \\
  f                   & + s = b & \forall s > 0           & \equiv & \text{(1)} \\
  s = b - f           &         & \forall x_1, x_2, \ldots &        & \text{(2)}
 \end{array}
\]

На кроці (1) ми ввели люзову змінну, а на кроці (2) -- перенесли $f$ в праву частину рівняння. Оскільки $b$ завжди позначає кількість доступного ресурсу, а $f$ -- функція, що обраховує кількість використаних (перемножуючи $x_1, x_2, \ldots$ на відповідні $a_{n1}, a_{n2}, \ldots$), то логічно, що $s$ можна інтерпретувати як \textit{кількість невикористаних ресурсів}.

\subsection{Система рівнянь з люзовими змінними}

Нехай маємо таку систему нерівностей:

\[
 \left\{
  \begin{array}{l}
   a_{11} x_1 + a_{12} x_2 \leq b_1 \\
   a_{21} x_1 + a_{22} x_2 \geq b_2
  \end{array}
 \right. .
\]

Введемо змінну $\delta_n$. Якщо $n$-на нерівність в системі має знак \flqq{}$\leq$\frqq{}, то $\delta_n=1$, а якщо навпаки -- то $\delta_n=-1$. Тепер систему нерівностей можна переписати як систему рівностей, а також отримати аналогічний запис у матрично-векторному-вигляді.

\begin{figure}[!h]
 \center
 \includegraphics{../imgs/linear/converting-to-matrix-vector.pdf}
\end{figure}

Ще коротший запис -- $\mathbf{A} \mathbf{X} + \mathbf{\delta} \mathbf{s} = \mathbf{b}$. Аналогічно можна представити систему нерівностей будь-якої вимірності.

\begin{problem}{problem:linear:convex_statement}
 Нехай $\mathbf{\delta}$ -- одинична матриця. Який висновок можна зробити про систему нерівностей?
\end{problem}

\begin{question}
 Нехай маємо двовимірну систему з двома рівняннями, як подано вище. $\delta_1 = \delta_2 = 1$. Змінним $x_1$ та $x_2$ присвоєно деякі значення так, що вони визначають розв'язок системи. Зрозуміло, що при зміні їхнього значення, $s_1$ та $s_2$ потрібно перерахувати -- тоді рівності знову справджуватимуться. Як вивести формулу для обрахунку нових значень люзових змінних?
\end{question}

\begin{problem}{problem:linear:new_x1x2}
 Аналізуємо ту саму систему рівнянь. Нехай при значеннях $s_1 = s_2 = 0$ система має деякий розв'язок $\mathbf{X} = \langle x_1, x_2 \rangle$, як показано на рисунку нижче. Очевидно, що якщо змінити значення $s_1$, то розв'язок системи теж зміниться. Як знайти його?
 \center
 \includegraphics{../imgs/linear/simple-slack-solution.pdf}
\end{problem}

\section{Симплекс-метод}
\label{section:linear:simplex}

З висновків на с. \pageref{conclusion:linear:optimal_solution} може з'явитись така ідея:

\begin{itemize}
 \item якщо оптимальний розв'язок розташований в одній з кутових точок, їх потрібно знайти (отримати список координат);
 \item опісля обраховуємо значення цінової функції $\varphi$ у всіх точках;
 \item обираємо точку з найбільшим $\varphi$, тобто найбільшою оптимальністю -- розв'язок знайдено;
 \item якщо якісь дві суміжні точки мають однакову оцінку ефективності, то весь відрізок між ними визначає оптимальні розв'язки (тобто, їх безліч).
\end{itemize}

Читач, який колись пробував конструювати власні алгоритми, може заперечити, що така ідея є рішенням \flqq{}в лоб\frqq{} (бо кутових точок може бути дуже багато), і подібні дії обов'язково призведуть до катастрофічного зростання часової та просторової складності алгоритму. Це справедливе зауваження, тому спробуймо трохи покращити метод:

\begin{itemize}
 \item спочатку обираємо деяку одну заздалегідь відому кутову точку, яку називатимемо \textbf{опорним планом}\footnote{(англ.) \textit{basic feasible solution}} -- наприклад~$\mathbf{X}_0 = {\langle 0, 0, \ldots \rangle}$;
 \item оцінюємо значення $\varphi$ у сусідніх точках, і рухаємось до тієї, яка має найбільшу оптимальність;
 \item якщо обидві сусідні точки мають менше значення оптимальності, поточне рішення і є розв'язком задачі.
\end{itemize}

Однак що, коли початок координат не є опорним планом? Насправді, якщо всі обмеження ОДР містять знак \flqq{}$\leq$\frqq{} або \flqq{}$<$\frqq{}, і одночасно ${\forall i:}\, {x_i \geq 0}$, цього ніколи не станеться. В інших випадках, звичайно, точка ${\langle 0, 0, \ldots \rangle}$ може і не бути допустимим розв'язком. Тоді для розв'язування задачі потрібно буде вводити \textbf{штучний базис}\footnote{(англ.) \textit{artificial basis}}. З цією технікою читач ознайомиться в наступних розділах.

\begin{note}
 Так стається тому, що під яким би кутом не була б нахилена межа обмеження \flqq{}$\leq$\frqq{}, область допустимих значень завжди буде спрямована до початку координат. Тому за умови дотатності всіх $x_i$ неможливо створити таку ОДР, щоби вона виключала точку ${\langle 0, 0, \ldots \rangle}$.
 \center
 \includegraphics{../imgs/linear/canonical-statement.pdf}
\end{note}

Отож, описана ідея і лежить в основі симплекс-методу. Тепер спробуймо сконструювати його реалізацію аналітично, використовуючи прості судження. Після цього читач отримає достатньо глибоке розуміння проблеми, щоби оцінити перевагу використання одного потужного та водночас досить простого інструменту -- симплекс-таблиці.

\subsection{Примітивна реалізація}

\textbf{Як оцінити оптимальність сусідньої точки?} \quad Припустимо, що цінова функція має вигляд $\varphi = 10 x_1 + 20 x_2$. На деякій ітерації ми перебуваємо в координатах $\mathbf{X}_0 = \langle 0, 0 \rangle$, а дві сусідні точки -- ${\mathbf{X}_\mathrm{A} = \langle 0, 5 \rangle}$ і ${\mathbf{X}_\mathrm{B} = \langle 5, 0 \rangle}$. Тепер, якщо ми рухатимемось до $\mathbf{X}_\mathrm{A}$, то змінюватиметься лише координата $x_2$, а $x_1=\mathrm{const}$. Аналогічно при переході до $\mathbf{X}_\mathrm{B}$ змінюється лише $x_1$. Тобто при виборі напрямку потрібно відповісти на таке питання: зміна якої зі змінних призводить до найбільшого зростання~$\varphi$? Очевидно, що якщо одночасно збільшувати обидва аргументи, то доданок $20x_2$ вносить більший вклад у зростання значення $\varphi$, ніж $10x_1$ -- це можна з'ясувати і простими логічними міркуваннями, і за допомогою апарату математичного аналізу, порівнявши $\dfrac{\partial \varphi}{\partial x_1}$ з $\dfrac{\partial \varphi}{\partial x_2}$. Висновок такий: перехід до $\mathbf{X}_\mathrm{A}$ дасть найбільше з можливих зростань значення цінової функції, тому оптимальний розв'язок на цій ітерації стане $\mathbf{X} = \langle 0, 5 \rangle$.

\begin{question}
 Нехай на поточній ітерації ми перебуваємо в точці $\langle x_0, y_0 \rangle$. Наступні сусідні точки -- $\langle x_1, y_1 \rangle$ і $\langle x_2, y_2 \rangle$, а цінова функція задана як $\varphi = x c_1 + y c_2$. Чи можна за рисунком оцінити, перехід до якої точки призведе до найбільшого зростання $\varphi$? Чи можна також зробити це аналітично, не обраховуючи значення $\varphi$? Якщо можна, то як? Чи працюватиме це для багатовимірних просторів?
 \center
 \includegraphics{../imgs/linear/steepest-point.pdf}
\end{question}

\textbf{Як оцінити оптимальність точок, перехід до яких вимагає зміну кількох координат одночасно?} \quad Якщо читач вже має відповідь на попереднє питання для роздумів, у нього, ймовірно, з'явилось кілька формул з використанням кутів між векторами абощо. Однак для цього прийнято використовувати дещо складніший з першого погляду, але простіший за обчисленнями спосіб. Головна ідея полягає в тому, щоби перехід до кожної сусідньої точки завжди вимагав збільшення лише однієї змінної цінової функції. В такому разі найоптимальніший напрямок завжди можна буде знайти за допомогою частинного диференціювання. Згодом читач помітить, що з цього можна вивести загальні формули, отож розв'язок ЛП буде абстрагованим від реального геометричного зображення ОДР. Вони працюватимуть для просторів будь-якої вимірності, і не вимагатимуть операцій складніших за ділення або множення.
\noclub

Отож, при розв'язування задачі симплекс-методом прийнято використовувати так звані \textbf{люзові змінні}\footnote{(англ.) \textit{slack variables} для нерівностей зі знаком~\flqq{}$\leq$\frqq{}, \textit{surplus variables} для нерівностей~\flqq{}$\geq$\frqq{}.}. Вони перетворюють нерівності виду ${f(x_1, x_2, \ldots) \leq b_i}$ у рівності ${ f(x_1, x_2, \ldots) + s_i = b_i }$. Тоді ОДР задачі можна записати так:

\[
 \begin{array}{l}
  a_{11} x_1 + \ldots + a_{1m} x_n + s_1 = b_1 \\
  a_{21} x_1 + \ldots + a_{2m} x_n + s_2 = b_2 \\
  \vdots
 \end{array}.
\]

Тепер умову можна переписати в матрично-векторному вигляді:

$$
 \left[
 \begin{array}{ccc}
  a_{11} & \cdots & a_{1n} \\
  \vdots & \ddots & \vdots \\
  a_{m1} & \cdots & a_{mn}
 \end{array}
 \right]
 \left[
 \begin{array}{c}
  x_1 \\ \vdots \\ x_n
 \end{array}
 \right] +
 I \left[
 \begin{array}{c}
  s_1 \\ \vdots \\ s_m
 \end{array}
 \right] =
 \left[
 \begin{array}{c}
  b_1 \\ \vdots \\ b_n
 \end{array}
 \right],
$$

де $I$ -- одинична матриця. Якщо позначити усі матриці через відповідні змінні, отримаємо ще коротший запис:

$$
\mathbf{A}\mathbf{X}^\top + I \mathbf{s} = \mathbf{b}.
$$

Постановка задачі лінійного програмування, яка записана лише за допомогою рівностей, і в якій потрібно максимізувати цінову функцію, називається \textbf{канонічною}\footnote{(англ.) \textit{canonical form}}.

Щоби зрозуміти сенс люзових зміних, прослідкуймо за таким перетворенням:

\begin{equation}
\begin{split}
 f(x_1, x_2, \ldots) + s_i = b_i \Rightarrow \\
 s_i = b_i - f(x_1, x_2, \ldots).
\end{split}
\label{eq:linear:slack_variables}
\end{equation}

Якщо $b_i$ позначає обмеження на доступні ресурси, а $f$ -- функція, яка обчислює значення використаних, то логічно, що $s_i$ позначатиме кількість невикористаних ресурсів. Отже, якщо ми змінюватимемо якесь $x_i$, то для того, щоби отримані рівняння справджувались, потрібно буде одразу перераховувати ${s_i \; \forall i}$. Так само й навпаки: якщо змінити якесь $s_i$, потрібно одночасно перерахувати решту змінних.

\begin{note}
 Це досить очевидно: якщо, наприклад, вирбництво одиниці продукту $x_1$ вимагає 2 одиниці ресурсу $s_1$ та 3 одиниці $s_2$, то нові значення змінних будуть $s_1 - 2 \Delta x_1$ та $s_2 - 3 \Delta x_1$ відповідно. Тут $\Delta x$ позначає зміну $x$.
\end{note}

\begin{question}
 Норма витрати $j$-ого ресурсу на $i$-ий продукт задана матрицею ${\mathbf{A} \in \mathbb{R}^{n \times m}}$. Виробництво усіх продуктів визначає вектор $\mathbf{X} = \langle x_1, \ldots, x_n \rangle$. Нехай на поточній ітерації значення усіх $x_i$ збільшилось на $\Delta \mathbf{X} = \langle \Delta x_1, \ldots, \Delta x_n \rangle$. Яким буде нове значення всіх $s_i$?
\end{question}

Проаналізуймо двовимірну задачу з ціновою функцією $\varphi = c_1 x_1 + c_2 x_2$ та ОДР як на Рис.~(\ref{pic:linear:slack_geometrical}), щоби зрозуміти геометричний сенс люзових змінних. Уявімо, що в процесі пошуку оптимального розв'язку алгоритм проходить маршрут $\mathbf{X}_0 \rightarrow \mathbf{X}_\mathrm{A} \rightarrow \mathbf{X}_\mathrm{B}$. Спробуймо змоделювати його поведінку.

\illustration
 {../imgs/linear/slack-geometrical.pdf}
 {Заштрихована область позначає ОДР. При руху по осі $x_1$ змінна $x_2$ залишається постійною. Аналогічно з віссю $x_2$. А от при руху по лінії одного з рівнянь незмінними залишаються $s_1$ або $s_2$, коли ж $x_1$ та $x_2$ одночасно змінюються.}
 {pic:linear:slack_geometrical}

\textbf{Крок 1.} \quad Перебуваючи в $\mathbf{X}_0$, ми можемо перейти до $\mathbf{X}_\mathrm{A}$ або $\mathbf{X}_\mathrm{C}$. Перехід до обох цих точок вимагає зміну лише або $x_1$ або $x_2$. Отже для оцінки оптимальності потрібно мати запис цінової функції у цих змінних, а тоді порівняти $\dfrac{\partial \varphi(x_1, x_2)}{\partial x_1}$ та $\dfrac{\partial \varphi(x_1, x_2)}{\partial x_2}$. Оскільки $\varphi$ лінійна функція, то для порівняння частинних похідних потрібно лише порівняти коефіцієнти біля відповідних змінних -- $c_1$ та $c_2$. Припустимо, що $c_2 > c_1$, тому найвигідніше збільшувати $x_2$. Отже збільшуємо цю змінну допоки не отримаємо координату точки $\mathbf{X}_\mathrm{A}$ -- це буде розв'язком на поточному кроці. Читач уже повинен розуміти, яким чином отримати нові значення $s_1$ та $s_2$.

В цьому випадку $x_1$ та $x_2$ називаються \textbf{вільними змінними}, а $s_1$ та $s_2$ -- \textbf{базисними змінними}\footnote{(англ.) \textit{nonbasis variables} та \textit{basis variables} відповідно}.

\textbf{Крок 2.} \quadТочка $\mathbf{X}_\mathbf{A}$ має дві сусідні: $\mathbf{X}_0$ та $\mathbf{X}_\mathrm{B}$. Перехід до кожної з них вимагає зміну лише або $x_2$ або $s_1$. Тому потрібно отримати цінову функцію, виражену у цих змінних. Це зробити зовсім нескладно. Візьмімо з ОДР задачі рівняння, яке містить $s_1$. Його можна переписати так:
 
 \[
 \begin{split}
  a_{11} x_1 + a_{12} x_2 + s_1 = b_1 \Rightarrow \\
  x_1 = \dfrac{b_1 - s_1 - a_{12} x_2}{a_{11}}.
 \end{split}
 \]
 
Тепер, підставляючи $x_1$ в $\varphi$, отримуємо запис цінової функції виражений лише у змінних $x_2$ та $s_1$:
 
\[
  \begin{split}
   \varphi = c_1 x_1 + c_2 x_2 = \\
   c_1 \dfrac{b_1 - s_1 - a_{12} x_2}{a_{11}} + c_2 x_2 \\
   c_1 a_{11} (b_1 - s_1 - a_{12} x_2) + a_{11} c_2 x_2 = \\
   c_1 a_{11} b_2 - c_1 a_{11} s_2 - c_1 a_{11} a_{12} x_2 + a_{11} c_2 x_2.
  \end{split}
\]

В цьому випадку ми кажемо, що змінна $s_1$ \textbf{вийшла з базису}\footnote{(англ.) \textit{leaving basis variable}}, а $x_1$ -- \textbf{увійшла в базис}\footnote{(англ.) \textit{entering basis varible}} замість неї.

Отримана функція завжди буде лінійною, тому з неї можна легко отримати частинні похідні $\dfrac{\partial \varphi(s_1, x_2)}{\partial s_1} = c_1 a_{11}$ та $\dfrac{\partial \varphi(s_1, x_2)}{\partial x_2} = c_1 a_{11} a_{12} + a_{11} c_2$. Припустимо, що порівнявши ці значення, ми з'ясували, що найвигідніше збільшувати $s_1$. Це потрібно робити доти, доки ми не досягнемо межі ОДР. Якщо отриманий розв'язок ${\langle x_1, x_2 \rangle}$ не буде оптимальним, потрібно знову оцінити, яку змінну варто замінити в базисі, отримати новий запис $\varphi$, і продовжувати змінювати вільні змінні.

\begin{note}
 Обрахувати нові $x_i$ при зміні котрогось із $s_i$ можна, розв'язавши систему лінійних рівнянь. Щоби отримати її, достатньо у кожному рівнянні ОДР перенести $s_i$ у праву частину, щоби отримати такий запис: $a_{i1} x_1 + a_{i2} x_2 = b_i - s_i \; \forall i$. Однак на цьому не варто зупиняти увагу, позаяк це не дуже практичний підхід. У розділі~\ref{section:linear:simplex_tableau} читач познайомиться із інструментом, який дозволяє уникнути цей крок.
\end{note}

\begin{note}
 Звичайно, якщо ми вже переконались, що ${\varphi(\mathbf{X}_0) < \varphi(\mathbf{X}_\mathrm{A})}$, то досить очевидно, що від $\mathbf{X}_\mathrm{A}$ залишається перейти лише до $\mathbf{X}_\mathrm{B}$ -- тобто, немає сенсу повертатись назад. Такі висновки мають хороше практичне значення, однак у комп'ютерній реалізації ми не надто збільшимо ефективність, запам'ятовуючи вже пройдені маршрути.
\end{note}

\begin{problem}{problem:linear:new_basis}
 Маємо постановку ЛП з $n$ змінними та $m$ рівняннями, тобто $\mathbf{A} \in \mathbb{R}^{n \times m}$. Нехай поточний базис -- $\langle s_1, s_2 \ldots, s_n \rangle$. З нього виходить змінна $s_7$, а натомість входить $x_5$. Якщо пронумерувати всі рівняння ОДР, то з якого з них потрібно виразити $x_5$, щоби потім підставити формулювання з $s_7$ у цінову функцію? А якби з базису виходила змінна $s_{10}$, і замість неї входила б $x_{28}$? Чи можна вивести якусь загальну формулу нових коефіцієнтів при змінних у ціновій функції з потрібним базисом?
\end{problem}

\textbf{Як визначити межу збільшення вільної змінної?} \quad

Спробуймо покроково розв'язати просту задачу з умовою (\ref{eq:linear:simplex:example_task}), щоби подивитись, чи це дійсно спрацює. Для наглядності працюватимемо спочатку з графікою.

\begin{equation}
 \begin{array}{rl}
  \text{оптимізувати}  & \varphi = 2 x_1 + 3 x_2 \rightarrow \max \\
  \text{з обмеженнями} & 2 x_1 +   x_2 \leq 4; \\
                       &   x_1 + 3 x_2 \leq 4.
 \end{array}
 \label{eq:linear:simplex:example_task}
\end{equation}

\begin{figure}
 \centering
 \includegraphics{../imgs/linear/simplex-tableau-1.pdf}
\end{figure}

\begin{figure}
 \centering
 \includegraphics{../imgs/linear/simplex-tableau-expl-1.pdf}
\end{figure}
\section{Цілочисельне лінійне програмування}
\label{section:linear:integer}

\section{Проблеми оптимального вибору}
\label{section:linear:x_in_0-1}

Припустимо таку ситуацію, коли ми маємо набір різних рішень, з яких складається розв'язок проблеми. Наприклад, \textit{складне обчислення можна розпаралелити на $n$ процесорів, кожен з яких має свою продуктивність операцій/с та потужність у ватах. Скільки і які процесори потрібно увімкнути, щоби продуктивності вистачило на виконання деякого обчислення у вказаний час, але спожити щонайменше енергії?} Тоді набір всіх можливих рішень

\[
\begin{split}
P = \{
 \text{увімкнути процесор 1},
 \text{увімкнути процесор 2},
 \ldots, \\
 \text{увімкнути процесор $n$}
\}
\end{split}
.
\]

Відповідно, будь-який розв'язок задачі буде лише підмножиною $P$. Однак такими формулюваннями оперувати дуже не дуже зручно, тому краще ввести характеристичний вектор $\mathbf{X}$, кожен елемент $x_i$ якого позначатиме, чи прийняте деяке $i$-те можливе рішення. Так, якщо $x_i=0$, то $i$-ий процесор варто вимкнути, але якщо $x_i=1$ -- то навпаки.

\begin{note}
 Формально такий випадок можна записати як $\mathbf{X} \in \{0, 1\}^{n}$, або простіше -- $\forall i: x_i \in \{0, 1\}$.
\end{note}

\clearpage
\blindsection{Розв'язування проблем}

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:integer_lp}}

Звичайно, на світі існує безліч ресурсів, які не вийде представити дробами: не можна відправити на роботу двох з половиною робітників, продати половину телевізора абощо. Тоді до умови ОДР додається ще одна: $\forall i: x_i \in \mathbb{Z}$. Пошук такого розв'язку може бути набагато складнішим, ніж коли $\forall i: x_i \in \mathbb{R}$.

\subsection*{Проблема №\arabic{chapter}.\ref{problem:linear:many_price_fn}}

Кілька цінових функцій може з'явитись тоді, коли розв'язок описується кількома характеристиками. Звичайно, якщо вони якимось чином залежать одна від одної, для спрощення задачі краще обійтись однією (або будь-яким іншим мінімальним числом). Наприклад, між відстанню, яку проходить автомобіль, та кількістю спожитого палива існує пряма залежність, тому при мінімізації чогось одного інша характеристика також зменшуватиметься вже без будь-якого впливу.

Проте якщо існують деякі $\varphi_1 \ldots \varphi_i$, і вони не є пов'язаними, то їх можна, наприклад, просто додати: $\varphi = \sum_i \varphi_i$. В такому разі мінімізація або максимізація $\varphi$ означатиме аналогічно зміну всіх $\varphi_i$.

Припустимо, що якусь $\varphi_n$ потрібно мінімізовувати, а решту $\varphi_i \; \forall {i \neq n}$ -- максимізовувати. Тоді $(-\varphi_n) \rightarrow \max \Rightarrow \varphi_n \rightarrow \min$. В такому разі сумарну оцінку можна сформувати як $\varphi = \varphi_1 + \ldots + \varphi_i - \varphi_n$ -- тоді умова $\varphi \rightarrow \max$ гарантуватиме правильне знаходження розв'язку.

Коли це може бути корисним? Припустимо, продукція різних видів $x_i$ по двох магазинах, де продається за різними цінами $c^{(a)}_i$ та $c^{(b)}_i$ відповідно. В такому разі \flqq{}вигода\frqq{} прийнятого рішення характеризуватиметься двома оцінками $\varphi_a$ та $\varphi_b$. Тоді максимізація $\varphi = \varphi_a + \varphi_b$ забезпечуватиме правильне знаходження розв'язку.

\end{document}

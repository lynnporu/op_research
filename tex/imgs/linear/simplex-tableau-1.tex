\documentclass{standalone}

\usepackage{tikz}

\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english, ukrainian]{babel}

\usepackage[default,scale=.90]{opensans}
\usepackage{newtxmath}

\renewcommand {\baselinestretch} {1.5}
\setlength\parindent{1cm}

% creates numerated cell
\newcounter{nodecount}
\newcommand\numcell[1]{
    \addtocounter{nodecount}{1}
    \tikz \node (\arabic{nodecount}) {#1};
}

% creates named cell
\newcommand\namecell[2]{
    \tikz \node (#1) {#2};
}

% creates label and points to the box in table
% #1 - parameters of lable (such as placement or smth)
% #2 - parameters of arrow
% #3 - point to this point's name
% #4 - set name of label's node
% #5 - text
% #6 - color
\newcommand\explain[6]{
    \node [explanation, fill=#6!30!white, #1]
        at (#3) (#4) {#5};
    \draw [
        thick, #2, #6
    ] (#3) to (#4);
}

% creates box with one row height
% #1 - color
% #2 - first node, #3 - second node
\newcommand\vboxontwo[3]{
 \draw [box, #1]
    (#2.north west) -- (#3.north east) --
    (#3.south east) -- (#2.south west) --
    cycle;
}

% box with one column width
\newcommand\hboxontwo[3]{
 \draw [box, #1]
    (#2.north west) -- (#2.north east) --
    (#3.south east) -- (#3.south west) --
    cycle;
}

\newcommand\singlebox[2]{
 \draw [box, #1]
    (#2.north west) -- (#2.north east) --
    (#2.south east) -- (#2.south west) --
    cycle;
}

\definecolor{palegreen}   {rgb}{0.6,  0.98, 0.6}
\definecolor{pastelorange}{rgb}{1.0,  0.7,  0.28}
\definecolor{pastelred}   {rgb}{1.0,  0.41, 0.38}
\definecolor{pastelblue}  {rgb}{0.68, 0.78, 0.81}
\definecolor{palegreen}   {rgb}{0.6,  0.98, 0.6}
\definecolor{pinkorange}  {rgb}{1.0,  0.6,  0.4}
\definecolor{magicmint}   {rgb}{0.67, 0.94, 0.82}
\definecolor{darkcyan}    {rgb}{0.0,  0.72, 0.92}
\definecolor{cream}       {rgb}{1.0,  0.99, 0.82}
\definecolor{lavender}    {rgb}{0.71, 0.49, 0.86}
\definecolor{mintgreen}  {rgb}{0.6,  1.0,  0.6}

\begin{document}

\tikzstyle{every picture}+=[remember picture,baseline]
\tikzstyle{every node}+=[anchor=base, outer sep=4pt, inner sep=0]

\begin{minipage}[t][171mm][c]{113mm}
 \setlength{\tabcolsep}{3pt}
 \begin{tabular}{llccccll}
  \textbf{}       & \textbf{Ціна}         & \namecell{price_cell1}{$2$}                  & $3$                  & $0$                  & \namecell{price_cell2}{$0$}                      &                         &                         \\
  \textbf{}       & \textbf{Змінні}       & \namecell{vars_cell1}{$x_1$}                & \namecell{vars_cell1_2}{$x_2$}                & $s_1$                & \namecell{vars_cell2}{$s_2$}                    & \textbf{План}           & \textbf{Межа}           \\
  \textbf{Базис}  &                       & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{} & \multicolumn{1}{l}{}     &                         &                         \\ \cline{3-6}
  \namecell{basis_cell1}{$s_1$}           & \multicolumn{1}{l|}{} & \namecell{a11_cell}{$2$}                  & $1$                  & $1$                  & \multicolumn{1}{c|}{$0$} & \multicolumn{1}{c}{\namecell{solution_cell1}{$4$}} & \multicolumn{1}{c}{\namecell{bound_cell1}{$3$}} \\
  \namecell{basis_cell2}{$s_2$}           & \multicolumn{1}{l|}{} & $1$                  & \namecell{a22_cell}{$3$}                  & $0$                  & \multicolumn{1}{c|}{$1$} & \multicolumn{1}{c}{\namecell{solution_cell2}{$4$}} & \multicolumn{1}{c}{\namecell{bound_cell2}{$1$}} \\ \cline{3-6}
  \textbf{Ризик}  &                       & \namecell{risk_cell1}{$0$}                  & $0$                  & $0$                  & \namecell{risk_cell2}{$0$}                      &                         &                         \\
  \textbf{Вигода} &                       & $2$                  & \namecell{profit_cell}{$3$}                  & $0$                  & $0$                      &                         &                        
 \end{tabular}
\end{minipage}
   
\begin{tikzpicture}[
    overlay,
    box/.style={thick, rounded corners},
    explanation/.style={
        align=left,
        text width=5cm,
        inner sep=5pt
    }
]

 % paths

 \vboxontwo{mintgreen}    {price_cell1}     {price_cell2};
 \singlebox{lavender}     {solution_cell1};
 \hboxontwo{pinkorange}   {bound_cell1}     {bound_cell2};
 \vboxontwo{magicmint}    {vars_cell1}      {vars_cell2};
 \hboxontwo{darkcyan}     {basis_cell1}     {basis_cell2};
 \vboxontwo{pastelblue}   {risk_cell1}      {risk_cell2};
 \singlebox{pastelred}    {profit_cell};
 \singlebox{pink}         {a11_cell};
 \singlebox{pink}         {a22_cell};
    
 % labels
    
 \explain
    {right=3.9cm, above=2.28cm, text width=3.8cm} {in=-160, out=45}
    {vars_cell2}{vars_box}
    {
        Рядок змінних відображає усі змінні, задіяні в обчисленнях.
    }
    {magicmint};
    
 \explain
    {right=0cm, above=-4cm} {in=90, out=180}
    {risk_cell1}{risk_box}
    {
        Значення втраченої вигоди від прийнятого рішення. На поточному кроці -- нульовий рядок.
    }
    {pastelblue};
    
 \explain
    {right=4.9cm, above=-4.8cm} {in=140, out=-30}
    {profit_cell}{profit_box}
    {
        На поточному кроці немає жодного ризику, тому вигода дорівнює ціні. Оскільки це найбільше значення в рядку, найвигідніше збільшувати $x_2$.
    }
    {pastelred};
    
 \explain
    {right=2.35cm, above=-8.0cm} {in=137, out=-95}
    {basis_cell2}{basis_box}
    {
        Базисні змінні -- це ті, що не дорівнюють нулю, і не підлягають збільшенню чи зменшенню. Отже змінюватимемо $x_1$ або $x_2$.
    }
    {darkcyan};
    
 \explain
    {right=-.3cm, above=3.6cm} {in=-145, out=180}
    {a11_cell}{a11_box}
    {
        Для збільшення $x_1$ на 1 потрібно зменшити $s_1$ на $a_{11}=2$. Аналогічно для решти чисел таблиці.
    }
    {pink};

 \explain
    {right=-2cm, above=4.5cm} {in=-10, out=70}
    {price_cell2}{price_box}
    {
        Рядок ціни задає коефіцієнти для цінової функції: $\varphi = 2 x_1 + 3 x_2 + 0 s_1 + 0 s_2$
    }
    {mintgreen};
    
 \explain
    {right=3cm, above=-2.6cm, text width= 3.8cm} {in=170, out=-120}
    {solution_cell1}{solution_box}
    {
        Поточне значення $s_1$.
    }
    {lavender};
    
 \explain
    {right=2.5cm, above=-1.7cm, text width=3.2cm} {in=200, out=0}
    {bound_cell1}{bound_box}
    {
        Якщо збільшуємо $x_2$, то наскільки щонайбільш, враховуючи доступні $s_1$ та $s_2$? \\ \ \\
        $\text{межа} = \dfrac{\text{план}}{a_{ij}}$
    }
    {pinkorange};
    
 \draw[->, thick, pink] (a11_cell) -- (vars_cell1);
 \draw[->, thick, pink] (a11_cell) -- (basis_cell1.12.5);
 
 \explain
    {right=-1.15cm, above=2.8cm, text width=2.6cm} {in=-145, out=180}
    {a22_cell}{a22_box}
    {
        Аналогічно, \\
        $x_2 + 1 \rightarrow s_2 - a_{22}$.
    }
    {pink};
 
 \draw[->, thick, pink] (a22_cell) -- (basis_cell2.12.5);
 \draw[->, thick, pink] (a22_cell) -- (vars_cell1_2);

\end{tikzpicture}

\end{document} 
